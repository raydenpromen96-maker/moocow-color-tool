<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MooCow Mini 调色工具 (Smart Match Ver.)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#2A58D1', secondary: '#F4C430', accent: '#B91D23',
            neutral: '#F5F7FA', dark: '#333333',
          },
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .slider-thumb { @apply appearance-none w-8 h-8 rounded-full cursor-pointer transition-all duration-200 hover:scale-125; }
      .paint-dot { @apply w-4 h-4 rounded-full border border-gray-300 mr-2 flex-shrink-0; }
      .lang-btn { @apply px-3 py-1.5 text-sm font-medium rounded-lg transition-all duration-200 border border-gray-200; }
    }
    input[type="range"] { 
      @apply appearance-none w-full h-4 rounded-full bg-gray-200 outline-none;
      touch-action: none;
      pointer-events: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      @apply slider-thumb;
      pointer-events: auto;
    }
    input[type="range"]::-moz-range-thumb {
      @apply slider-thumb;
      pointer-events: auto;
    }
    input[type="range"]::-ms-thumb {
      @apply slider-thumb;
      pointer-events: auto;
    }
    input[type="range"]:disabled {
      @apply bg-gray-300 cursor-not-allowed;
    }
    input[type="range"]:disabled::-webkit-slider-thumb {
      @apply cursor-not-allowed;
      pointer-events: none;
    }
    input[type="range"]:disabled::-moz-range-thumb {
      @apply cursor-not-allowed;
      pointer-events: none;
    }
    input[type="range"]:disabled::-ms-thumb {
      @apply cursor-not-allowed;
      pointer-events: none;
    }
    /* Slider Colors Mapping */
    #sliderY83S::-webkit-slider-thumb { @apply bg-[#F4C430]; }
    #sliderY74S::-webkit-slider-thumb { @apply bg-[#F4C430]; }
    #sliderB150S::-webkit-slider-thumb { @apply bg-[#2A58D1]; }
    #sliderR254D::-webkit-slider-thumb { @apply bg-[#B91D23]; }
    #sliderR101Y::-webkit-slider-thumb { @apply bg-[#B91D23]; }
    #sliderR101V::-webkit-slider-thumb { @apply bg-[#B91D23]; }
    #sliderY42S::-webkit-slider-thumb { @apply bg-[#F4C430]; }
    #sliderW064::-webkit-slider-thumb { @apply bg-white border border-gray-300; }
    #sliderV23::-webkit-slider-thumb { @apply bg-[#800080]; }
    #sliderG7::-webkit-slider-thumb { @apply bg-[#229954]; }
    #sliderR122S::-webkit-slider-thumb { @apply bg-[#B91D23]; }
    #sliderBK7H::-webkit-slider-thumb { @apply bg-[#000000]; }
    .lang-btn.active { @apply bg-primary text-white border-primary; }
    .lang-btn:not(.active) { @apply bg-white text-gray-600 hover:bg-gray-50; }
  </style>
</head>
<body class="bg-neutral font-sans text-dark min-h-screen py-4 md:py-8 px-4 md:px-6">
  <div class="max-w-3xl mx-auto bg-white rounded-2xl shadow-lg overflow-hidden">
    <div class="bg-primary text-white p-6 md:p-8 relative overflow-hidden">
      <!-- Decorative element -->
      <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"></div>
      
      <div class="relative z-10 flex items-center justify-between flex-wrap gap-2">
        <div class="flex items-center gap-3">
          <h1 class="text-2xl md:text-3xl font-bold">MooCow Mini <span class="text-xs opacity-70 font-normal border border-white/30 rounded px-1">SMART</span></h1>
        </div>
        <div class="flex items-center gap-3">
          <span class="text-white/80 text-sm md:text-base" data-i18n="subtitle"></span>
          <div class="flex gap-1 bg-white/10 rounded-lg p-1">
            <button class="lang-btn" data-lang="zh" title="中文">中</button>
            <button class="lang-btn" data-lang="en" title="English">EN</button>
            <button class="lang-btn" data-lang="ja" title="日本語">日</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="p-6 md:p-8 space-y-8">
      <!-- Disclaimer -->
      <div id="disclaimer" class="p-3 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-lg">
        <div class="flex items-start gap-3">
          <div class="flex-shrink-0 text-yellow-500 pt-0.5"><i class="fa fa-info-circle"></i></div>
          <div>
            <h3 class="text-sm font-bold text-yellow-800" data-i18n="disclaimer_title"></h3>
            <p class="text-xs text-yellow-700 mt-1" data-i18n="disclaimer_text"></p>
          </div>
        </div>
      </div>
      
      <!-- Step 1: Color Selection -->
      <section class="space-y-4">
        <div class="flex items-center gap-2 text-primary font-bold">
          <span class="w-6 h-6 rounded-full bg-primary text-white flex items-center justify-center text-sm">1</span>
          <h2 class="text-lg" data-i18n="target_color_selection"></h2>
        </div>
        <div class="bg-neutral rounded-xl p-4 md:p-5 space-y-4">
          <div class="flex flex-col md:flex-row gap-5">
            <div class="w-full md:w-24 h-24 md:h-auto rounded-lg border-2 border-gray-200 overflow-hidden shadow-sm">
              <div id="colorSwatch" class="w-full h-full transition-colors duration-300"></div>
            </div>
            <div class="flex-1 space-y-3">
              <div>
                <label for="ralSearch" class="block text-sm text-gray-600 mb-1" data-i18n="ral_search_label"></label>
                <div class="relative">
                  <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><i class="fa fa-search"></i></span>
                  <input type="text" id="ralSearch" data-i18n-placeholder="ral_search_placeholder" class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 outline-none">
                  <div id="searchSuggestions" class="absolute w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 max-h-60 overflow-y-auto hidden"></div>
                </div>
              </div>
              <div>
                <label for="ralSelect" class="block text-sm text-gray-600 mb-1" data-i18n="ral_select_label"></label>
                <select id="ralSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg appearance-none bg-white focus:ring-2 focus:ring-primary/50 outline-none"></select>
              </div>
              <div class="text-sm text-gray-600 flex flex-wrap gap-x-4 gap-y-1 pt-1">
                <span data-i18n="current_ral">当前RAL:<span id="currentRalCode" class="font-medium text-primary"></span></span>
                <span data-i18n="color_value">颜色值:<span id="currentHex" class="font-medium text-primary"></span></span>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Step 2: Adjustment -->
      <section class="space-y-4">
        <div class="flex items-center gap-2 text-primary font-bold">
          <span class="w-6 h-6 rounded-full bg-primary text-white flex items-center justify-center text-sm">2</span>
          <h2 class="text-lg" data-i18n="paint_weight_adjustment"></h2>
        </div>
        <div class="bg-neutral rounded-xl p-4 md:p-5 space-y-5">
          <div class="flex flex-wrap items-center gap-x-6 gap-y-3">
            <div class="flex items-center gap-3">
              <label for="volumeSelect" class="text-sm text-gray-600" data-i18n="volume_selection"></label>
              <select id="volumeSelect" class="max-w-[150px] px-3 py-2 border border-gray-300 rounded-lg appearance-none bg-white focus:ring-2 focus:ring-primary/50 outline-none">
                <option value="500ml">500ML</option>
                <option value="1l" selected>1L</option>
                <option value="5l">5L</option>
                <option value="20l">20L</option>
              </select>
            </div>
            <p class="text-xs text-gray-500" data-i18n="volume_hint"></p>
          </div>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4" id="paintSlidersContainer"></div>
          
          <div class="bg-white p-4 rounded-lg border border-gray-100">
            <h3 class="text-sm font-medium mb-3" data-i18n="paint_ratio"></h3>
            <div class="flex flex-col lg:flex-row gap-4 items-center">
              <div class="w-full lg:w-1/2 h-[180px]">
                <canvas id="paintChart"></canvas>
              </div>
              <div class="w-full lg:w-1/2 space-y-2 text-sm">
                <div><span data-i18n="total_pigment_weight"></span><strong id="totalPigmentWeight" class="text-primary text-base">0.0g</strong><span id="scoopEstimate" class="text-xs text-gray-500 ml-2"></span></div>
                <div><span data-i18n="varnish_usage"></span><strong id="varnishAmount" class="text-gray-700">1L</strong></div>
                <div><span data-i18n="per_liter_usage"></span><strong id="perLiterAmount" class="text-gray-700">0.0g</strong></div>
                <div class="text-accent font-semibold"><span data-i18n="mixing_ratio"></span><strong id="mixingRatio">0 : 100</strong></div>
                
                <div class="flex flex-wrap gap-2 pt-2">
                  <button id="resetFormulaBtn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-300 transition"><i class="fa fa-refresh mr-1"></i><span data-i18n="reset_formula"></span></button>
                  <button id="addFormulaBtn" class="px-4 py-2 bg-secondary text-dark rounded-lg text-sm font-medium hover:bg-secondary/90 transition-transform hover:scale-105"><i class="fa fa-plus-circle mr-1"></i><span data-i18n="add_formula"></span></button>
                  <button id="generateRecipeBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-transform hover:scale-105 shadow-md"><i class="fa fa-magic mr-1"></i><span data-i18n="generate_recipe"></span></button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Step 3: Export -->
      <section class="space-y-4">
        <div class="flex items-center gap-2 text-primary font-bold">
          <span class="w-6 h-6 rounded-full bg-primary text-white flex items-center justify-center text-sm">3</span>
          <h2 class="text-lg" data-i18n="package_preview_export"></h2>
        </div>
         <div class="bg-neutral rounded-xl p-4 md:p-5 space-y-5">
            <div class="flex flex-col md:flex-row gap-6">
                <div class="w-full md:w-1/3 space-y-3">
                    <button id="exportRecipeBtn" class="w-full py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition flex items-center justify-center gap-2"><i class="fa fa-download"></i><span data-i18n="export_recipe"></span></button>
                    <div class="flex gap-2">
                        <button id="copyRecipeBtn" class="flex-1 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 transition flex items-center justify-center gap-1 text-sm"><i class="fa fa-copy"></i><span data-i18n="copy_recipe"></span></button>
                        <button id="shareRecipeBtn" class="flex-1 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition flex items-center justify-center gap-1 text-sm"><i class="fa fa-share-alt"></i><span data-i18n="share_recipe"></span></button>
                    </div>
                     <div class="bg-white p-3 rounded-lg border border-gray-100">
                        <h3 class="text-sm font-medium mb-2" data-i18n="recipe_includes_title"></h3>
                        <ul class="text-xs text-gray-600 space-y-1" data-i18n="recipe_includes_list"></ul>
                    </div>
                </div>
                <div class="w-full md:w-2/3 flex justify-center items-center pt-8">
                    <!-- Can visualization -->
                    <div class="relative" style="width: 120px; height: 160px;">
                        <div class="absolute bottom-0 left-0 w-full h-[140px] bg-gray-200 rounded-t-lg border-2 border-gray-400/50 shadow-inner" style="background-image: linear-gradient(to right, rgba(255,255,255,0.2), rgba(0,0,0,0.2));">
                            <div id="canBody" class="absolute inset-0 transition-colors duration-500"></div>
                        </div>
                        <!-- Handle -->
                        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-[90%] h-6 bg-gray-600 rounded-t-md border-t-2 border-l-2 border-r-2 border-gray-700" style="background-image: linear-gradient(to right, #888, #555);"></div>
                        <!-- Label -->
                        <div class="absolute top-[calc(50%-20px)] left-1/2 -translate-x-1/2 bg-white px-3 py-1.5 rounded shadow-md text-center">
                            <span id="canLabel" class="font-bold text-gray-800 text-sm"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
      </section>

      <!-- Presets & Palette -->
      <section class="space-y-2">
        <h3 class="text-base font-bold text-gray-700" data-i18n="recommended_recipes"></h3>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3" id="recipePresetsContainer"></div>
      </section>
      
      <section class="space-y-2">
        <h3 class="text-base font-bold text-gray-700" data-i18n="ral_palette"></h3>
        <div class="grid grid-cols-3 md:grid-cols-6 gap-3 overflow-y-auto max-h-96" id="ralPaletteContainer"></div>
      </section>
    </div>
  </div>
  
  <div id="notification" class="fixed bottom-4 right-4 bg-dark text-white px-4 py-3 rounded-lg shadow-lg transform translate-y-24 opacity-0 transition-all z-50 text-sm"></div>
  
  <script>
    const TRANSLATIONS={zh:{subtitle:"智能调色工具",disclaimer_title:"算法升级说明",disclaimer_text:"本版本采用'色相定点-亮度拟合'算法。准确度较旧版大幅提升，但仍受限于屏幕色差，实际生产请务必先小样试喷。",target_color_selection:"目标颜色选择",ral_search_label:"RAL代码搜索",ral_search_placeholder:"输入代码或颜色名",ral_select_label:"RAL代码选择",select_ral_code:"选择RAL代码",current_ral:"当前RAL:",color_value:"颜色值:",paint_weight_adjustment:"颜料重量调节",volume_selection:"基料容量:",volume_hint:"(切换容量将自动重算配方克重)",paint_ratio:"混合详情",total_pigment_weight:"总颜料重量: ",varnish_usage:"基料用量: ",per_liter_usage:"每升用量: ",mixing_ratio:"混合比例: 颜料 : 基料 = ",add_formula:"微调配方 (+5%)",reset_formula:"清空颜料",recommended_recipes:"推荐配方库 (点击加载配方)",package_preview_export:"包装预览与配方导出",export_recipe:"导出配方",copy_recipe:"复制配方",share_recipe:"分享",recipe_includes_title:"配方包含:",recipe_includes_list:`<li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>RAL代码和颜色</li><li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>各颜料精确重量</li><li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>基料用量与比例</li>`,generate_recipe:"智能生成配方",ral_palette:"RAL颜色调色板 (点击选择)"},en:{subtitle:"Smart Color Tool",disclaimer_title:"Algorithm Update",disclaimer_text:"Using 'Hue-Luminance' fitting. Accuracy is improved, but spray a test sample first due to screen differences.",target_color_selection:"Target Color",ral_search_label:"RAL Code Search",ral_search_placeholder:"Enter code or name",ral_select_label:"RAL Code Selection",select_ral_code:"Select RAL Code",current_ral:"Current RAL:",color_value:"Color Value:",paint_weight_adjustment:"Pigment Adjustment",volume_selection:"Base Volume:",volume_hint:"(Changing volume recalculates weights)",paint_ratio:"Mix Details",total_pigment_weight:"Total Pigment: ",varnish_usage:"Base Amount: ",per_liter_usage:"Per Liter: ",mixing_ratio:"Ratio: P:B = ",add_formula:"Fine-tune (+5%)",reset_formula:"Clear Pigments",recommended_recipes:"Recommended Recipes (Click to load)",package_preview_export:"Preview & Export",export_recipe:"Export Recipe",copy_recipe:"Copy Recipe",share_recipe:"Share",recipe_includes_title:"Recipe includes:",recipe_includes_list:`<li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>RAL Code & Color</li><li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>Precise Pigment Weights</li><li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>Base Amount & Ratio</li>`,generate_recipe:"Smart Generate",ral_palette:"RAL Color Palette (Click to select)"},ja:{subtitle:"スマート調色",disclaimer_title:"アルゴリズム更新",disclaimer_text:"「色相-輝度」フィッティングを採用。精度は向上しましたが、画面差があるため必ず試し塗りをしてください。",target_color_selection:"ターゲット色",ral_search_label:"RALコード検索",ral_search_placeholder:"コードまたは色名",ral_select_label:"RALコード選択",select_ral_code:"RALコードを選択",current_ral:"現在のRAL:",color_value:"色値:",paint_weight_adjustment:"顔料調整",volume_selection:"ベース容量:",volume_hint:"(容量変更で重量を再計算)",paint_ratio:"混合詳細",total_pigment_weight:"総顔料: ",varnish_usage:"ベース材: ",per_liter_usage:"リットル当たり: ",mixing_ratio:"混合比: P:B = ",add_formula:"微調整 (+5%)",reset_formula:"クリア",recommended_recipes:"推奨配合 (クリック読込)",package_preview_export:"プレビューとエクスポート",export_recipe:"配合をエクスポート",copy_recipe:"配合をコピー",share_recipe:"共有",recipe_includes_title:"レシピ内容:",recipe_includes_list:`<li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>RALコードと色</li><li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>正確な顔料重量</li><li class="flex items-center gap-1.5"><i class="fa fa-check text-green-500"></i>ベース量と比率</li>`,generate_recipe:"スマート生成",ral_palette:"RALカラーパレット (クリックして選択)"}};

    // 移除艳蓝(B153S)和橙色(073)，保留其他并加入Strength数据
    const PAINT_DATA = {
        Y74S: { name_zh: "中黄 (Colanyl Yellow 2GXD)", name_en: "Yellow 2GXD", hex: "#fedd00", strength: 1.0, batch: "CNQ1190325" },
        Y83S: { name_zh: "金黄 (Colanyl Yellow HR)", name_en: "Yellow HR", hex: "#ffc700", strength: 1.0, batch: "CNQ1340322" },
        R254D: { name_zh: "大红 (Colanyl DPP Red GD)", name_en: "DPP Red GD", hex: "#d8001d", strength: 1.515, batch: "CNQ1471124" },
        R101Y: { name_zh: "铁红黄相 (Colanyl Oxide Red G)", name_en: "Oxide Red G", hex: "#c0392b", strength: 1.287, batch: "CNG2340320" },
        R101V: { name_zh: "铁红紫相 (Ecosperse Oxide Red BA)", name_en: "Oxide Red BA", hex: "#a93226", strength: 1.304, batch: "CNG2940223" },
        R122S: { name_zh: "玫红 (Colanyl Pink E)", name_en: "Pink E", hex: "#e4007f", strength: 1.089, batch: "CNQ1361125" },
        V23: { name_zh: "紫色 (Colanyl Violet RL)", name_en: "Violet RL", hex: "#8e44ad", strength: 1.188, batch: "CNQ1350313" },
        B150S: { name_zh: "宝蓝 (Colanyl Blue A2R)", name_en: "Blue A2R", hex: "#0057b7", strength: 1.4, batch: "CNQ1118121" },
        G7: { name_zh: "绿色 (Colanyl Green GG)", name_en: "Green GG", hex: "#009a44", strength: 0.99, batch: "CNQ1321013" },
        Y42S: { name_zh: "铁黄 (Ecosperse Oxide Yellow RA)", name_en: "Oxide Yellow RA", hex: "#e8a317", strength: 1.01, batch: "CNG2280220" },
        BK7H: { name_zh: "黑色 (Colanyl Black N)", name_en: "Black N", hex: "#1c1c1c", strength: 2.0, batch: "CNQ1361225", manualLab: [5, 0, 0] },
        W064: { name_zh: "白色 (Colanyl White TQ)", name_en: "White TQ", hex: "#ffffff", strength: 0.099, batch: "CNQ1431113", manualLab: [98, 0, 0] }
    };

    const ralPaintMap = [{"ral": "RAL 1000","name_en": "Green beige","name_zh": "绿色米色","name_ja": "グリーンベージュ","hex": "#BEBD7F"},{"ral": "RAL 1001","name_en": "Beige","name_zh": "米色","name_ja": "ベージュ","hex": "#C2B078"},{"ral": "RAL 1002","name_en": "Sand yellow","name_zh": "沙黄色","name_ja": "サンドイエロー","hex": "#C6A664"},{"ral": "RAL 1003","name_en": "Signal yellow","name_zh": "信号黄","name_ja": "シグナルイエロー","hex": "#E5BE01"},{"ral": "RAL 1004","name_en": "Golden yellow","name_zh": "金黄","name_ja": "ゴールデンイエロー","hex": "#CDA434"},{"ral": "RAL 1005","name_en": "Honey yellow","name_zh": "蜂蜜黄","name_ja": "ハニ―イエロー","hex": "#A98307"},{"ral": "RAL 1006","name_en": "Maize yellow","name_zh": "玉米黄","name_ja": "メイズイエロー","hex": "#E4A010"},{"ral": "RAL 1007","name_en": "Daffodil yellow","name_zh": "水仙黄","name_ja": "ダフォディルイエロー","hex": "#DC9D00"},{"ral": "RAL 1011","name_en": "Brown beige","name_zh": "棕米色","name_ja": "ブラウンベージュ","hex": "#8A6642"},{"ral": "RAL 1012","name_en": "Lemon yellow","name_zh": "柠檬黄","name_ja": "レモンイエロー","hex": "#C7B446"},{"ral": "RAL 1013","name_en": "Oyster white","name_zh": "牡蛎白","name_ja": "オイスターホワイト","hex": "#EAE6CA"},{"ral": "RAL 1014","name_en": "Ivory","name_zh": "象牙色","name_ja": "アイボリー","hex": "#E1CC4F"},{"ral": "RAL 1015","name_en": "Light ivory","name_zh": "浅象牙","name_ja": "ライトアイボリー","hex": "#E6D690"},{"ral": "RAL 1016","name_en": "Sulfur yellow","name_zh": "硫黄黄","name_ja": "サルファーイエロー","hex": "#EDFF21"},{"ral": "RAL 1017","name_en": "Saffron yellow","name_zh": "藏红花黄","name_ja": "サフランイエロー","hex": "#F5D033"},{"ral": "RAL 1018","name_en": "Zinc yellow","name_zh": "锌黄","name_ja": "ジンクイエロー","hex": "#F8F32B"},{"ral": "RAL 1019","name_en": "Grey beige","name_zh": "灰米色","name_ja": "グレーベージュ","hex": "#9E9764"},{"ral": "RAL 1020","name_en": "Olive yellow","name_zh": "橄榄黄","name_ja": "オリーブイエロー","hex": "#999950"},{"ral": "RAL 1021","name_en": "Rape Yellow","name_zh": "油菜黄","name_ja": "レイプイエロー","hex": "#F3DA0B"},{"ral": "RAL 1023","name_en": "Traffic yellow","name_zh": "交通黄","name_ja": "トラフィックイエロー","hex": "#FAD201"},{"ral": "RAL 1024","name_en": "Ochre yellow","name_zh": "赭黄","name_ja": "オーカーイエロー","hex": "#AEA04B"},{"ral": "RAL 1026","name_en": "Luminous yellow","name_zh": "荧光黄","name_ja": "ルミナスイエロー","hex": "#FFFF00"},{"ral": "RAL 1027","name_en": "Curry","name_zh": "咖喱色","name_ja": "カリー","hex": "#9D9101"},{"ral": "RAL 1028","name_en": "Melon yellow","name_zh": "哈密瓜黄","name_ja": "メロンイエロー","hex": "#F4A900"},{"ral": "RAL 1032","name_en": "Broom yellow","name_zh": "扫帚黄","name_ja": "ブルームイエロー","hex": "#D6AE01"},{"ral": "RAL 1033","name_en": "Dahlia yellow","name_zh": "大丽花黄","name_ja": "ダリアイエロー","hex": "#F3A505"},{"ral": "RAL 1034","name_en": "Pastel yellow","name_zh": "粉黄","name_ja": "パステルイエロー","hex": "#EDAB56"},{"ral": "RAL 1035","name_en": "Pearl beige","name_zh": "珠光米色","name_ja": "パールベージュ","hex": "#A29985"},{"ral": "RAL 1036","name_en": "Pearl gold","name_zh": "珠光金","name_ja": "パールゴールド","hex": "#927549"},{"ral": "RAL 1037","name_en": "Sun yellow","name_zh": "阳光黄","name_ja": "サンイエロー","hex": "#EEA205"},{"ral": "RAL 1039","name_en": "Sand Beige","name_zh": "沙米色","name_ja": "サンドベージュ","hex": "#A18F60"},{"ral": "RAL 2000","name_en": "Yellow Orange","name_zh": "黄橙色","name_ja": "イエローオレンジ","hex": "#ED760E"},{"ral": "RAL 2001","name_en": "Red Orange","name_zh": "红橙色","name_ja": "レッドオレンジ","hex": "#C93C20"},{"ral": "RAL 2002","name_en": "Vermilion","name_zh": "朱红","name_ja": "バーミリオン","hex": "#CB2821"},{"ral": "RAL 2003","name_en": "Pastel Orange","name_zh": "粉橙","name_ja": "パステルオレンジ","hex": "#FF7514"},{"ral": "RAL 2004","name_en": "Pure Orange","name_zh": "纯橙色","name_ja": "ピュアオレンジ","hex": "#F44611"},{"ral": "RAL 2008","name_en": "Bright Red Orange","name_zh": "亮红橙","name_ja": "ブライトレッドオレンジ","hex": "#EC7C26"},{"ral": "RAL 2009","name_en": "Traffic Orange","name_zh": "交通橙","name_ja": "トラフィックオレンジ","hex": "#E55137"},{"ral": "RAL 2010","name_en": "Signal Orange","name_zh": "信号橙","name_ja": "シグナルオレンジ","hex": "#D4652F"},{"ral": "RAL 2011","name_en": "Deep Orange","name_zh": "深橙色","name_ja": "ディープオレンジ","hex": "#EC7C26"},{"ral": "RAL 2012","name_en": "Salmon Orange","name_zh": "鲑橙色","name_ja": "サーモンオレンジ","hex": "#DB6A50"},{"ral": "RAL 2013","name_en": "Pearl Orange","name_zh": "珠光橙","name_ja": "パールオレンジ","hex": "#954527"},{"ral": "RAL 2017","name_en": "Signal Carrot Orange","name_zh": "胡萝卜橙","name_ja": "キャロットオレンジ","hex": "#DD6A00"},{"ral": "RAL 3000","name_en": "Flame red","name_zh": "火焰红","name_ja": "Flame red","hex": "#AF2B1E"},{"ral": "RAL 3001","name_en": "Signal red","name_zh": "信号红","name_ja": "Signal red","hex": "#A52019"},{"ral": "RAL 3002","name_en": "Carmine red","name_zh": "胭脂红","name_ja": "Carmine red","hex": "#A2231D"},{"ral": "RAL 3003","name_en": "Ruby red","name_zh": "红宝石红","name_ja": "Ruby red","hex": "#8A1C1C"},{"ral": "RAL 3020","name_en": "Traffic red","name_zh": "交通红","name_ja": "Traffic red","hex": "#CC0605"},{"ral": "RAL 5005","name_en": "Signal blue","name_zh": "信号蓝","name_ja": "Signal blue","hex": "#1E2460"},{"ral": "RAL 7035","name_en": "Light grey","name_zh": "浅灰","name_ja": "Light grey","hex": "#CBD0CC"},{"ral": "RAL 9002","name_en": "Grey white","name_zh": "灰白","name_ja": "Grey white","hex": "#E7EBDA"},{"ral": "RAL 3000","name_en": "Flame red","name_zh": "Flame red","name_ja": "Flame red","hex": "#A72920"},{"ral": "RAL 3001","name_en": "Signal red","name_zh": "Signal red","name_ja": "Signal red","hex": "#9B2423"},{"ral": "RAL 3002","name_en": "Carmine red","name_zh": "Carmine red","name_ja": "Carmine red","hex": "#9B2321"},{"ral": "RAL 3003","name_en": "Ruby red","name_zh": "Ruby red","name_ja": "Ruby red","hex": "#861A22"},{"ral": "RAL 3004","name_en": "Purple red","name_zh": "Purple red","name_ja": "Purple red","hex": "#6B1C23"},{"ral": "RAL 3005","name_en": "Wine red","name_zh": "Wine red","name_ja": "Wine red","hex": "#59191F"},{"ral": "RAL 3007","name_en": "Black red","name_zh": "Black red","name_ja": "Black red","hex": "#3E2022"},{"ral": "RAL 3009","name_en": "Oxide red","name_zh": "Oxide red","name_ja": "Oxide red","hex": "#6D342D"},{"ral": "RAL 3011","name_en": "Brown red","name_zh": "Brown red","name_ja": "Brown red","hex": "#782423"},{"ral": "RAL 3012","name_en": "Beige red","name_zh": "Beige red","name_ja": "Beige red","hex": "#C5856D"},{"ral": "RAL 3013","name_en": "Tomato red","name_zh": "Tomato red","name_ja": "Tomato red","hex": "#972E25"},{"ral": "RAL 3014","name_en": "Antique pink","name_zh": "Antique pink","name_ja": "Antique pink","hex": "#CB7375"},{"ral": "RAL 3015","name_en": "Light pink","name_zh": "Light pink","name_ja": "Light pink","hex": "#D8A0A6"},{"ral": "RAL 3016","name_en": "Coral red","name_zh": "Coral red","name_ja": "Coral red","hex": "#A63D30"},{"ral": "RAL 3017","name_en": "Rose","name_zh": "Rose","name_ja": "Rose","hex": "#CA555D"},{"ral": "RAL 3018","name_en": "Strawberry red","name_zh": "Strawberry red","name_ja": "Strawberry red","hex": "#C63F4A"},{"ral": "RAL 3020","name_en": "Traffic red","name_zh": "Traffic red","name_ja": "Traffic red","hex": "#BB1F11"},{"ral": "RAL 3022","name_en": "Salmon pink","name_zh": "Salmon pink","name_ja": "Salmon pink","hex": "#CF6955"},{"ral": "RAL 3024","name_en": "Luminous red","name_zh": "Luminous red","name_ja": "Luminous red","hex": "#FF2D21"},{"ral": "RAL 3026","name_en": "Luminous bright red","name_zh": "Luminous bright red","name_ja": "Luminous bright red","hex": "#FF2A1C"},{"ral": "RAL 3027","name_en": "Raspberry red","name_zh": "Raspberry red","name_ja": "Raspberry red","hex": "#AB273C"},{"ral": "RAL 3028","name_en": "Pure red","name_zh": "Pure red","name_ja": "Pure red","hex": "#CC2C24"},{"ral": "RAL 3031","name_en": "Orient red","name_zh": "Orient red","name_ja": "Orient red","hex": "#A63437"},{"ral": "RAL 3032","name_en": "Pearl ruby red","name_zh": "Pearl ruby red","name_ja": "Pearl ruby red","hex": "#701D24"},{"ral": "RAL 3033","name_en": "Pearl pink","name_zh": "Pearl pink","name_ja": "Pearl pink","hex": "#A53A2E"},{"ral": "RAL 4001","name_en": "Red lilac","name_zh": "Red lilac","name_ja": "Red lilac","hex": "#816183"},{"ral": "RAL 4002","name_en": "Red violet","name_zh": "Red violet","name_ja": "Red violet","hex": "#8D3C4B"},{"ral": "RAL 4003","name_en": "Heather violet","name_zh": "Heather violet","name_ja": "Heather violet","hex": "#C4618C"},{"ral": "RAL 4004","name_en": "Claret violet","name_zh": "Claret violet","name_ja": "Claret violet","hex": "#651E38"},{"ral": "RAL 4005","name_en": "Blue lilac","name_zh": "Blue lilac","name_ja": "Blue lilac","hex": "#76689A"},{"ral": "RAL 4006","name_en": "Traffic purple","name_zh": "Traffic purple","name_ja": "Traffic purple","hex": "#903373"},{"ral": "RAL 4007","name_en": "Purple violet","name_zh": "Purple violet","name_ja": "Purple violet","hex": "#47243C"},{"ral": "RAL 4008","name_en": "Signal violet","name_zh": "Signal violet","name_ja": "Signal violet","hex": "#844C82"},{"ral": "RAL 4009","name_en": "Pastel violet","name_zh": "Pastel violet","name_ja": "Pastel violet","hex": "#9D8692"},{"ral": "RAL 4010","name_en": "Telemagenta","name_zh": "Telemagenta","name_ja": "Telemagenta","hex": "#BB4077"},{"ral": "RAL 4011","name_en": "Pearl violet","name_zh": "Pearl violet","name_ja": "Pearl violet","hex": "#6E6387"},{"ral": "RAL 4012","name_en": "Pearl blackberry","name_zh": "Pearl blackberry","name_ja": "Pearl blackberry","hex": "#6A6B7F"},{"ral": "RAL 5000","name_en": "Violet blue","name_zh": "Violet blue","name_ja": "Violet blue","hex": "#304F6E"},{"ral": "RAL 5001","name_en": "Green blue","name_zh": "Green blue","name_ja": "Green blue","hex": "#0E4C64"},{"ral": "RAL 5002","name_en": "Ultramarine blue","name_zh": "Ultramarine blue","name_ja": "Ultramarine blue","hex": "#00387A"},{"ral": "RAL 5003","name_en": "Sapphire blue","name_zh": "Sapphire blue","name_ja": "Sapphire blue","hex": "#1F3855"},{"ral": "RAL 5004","name_en": "Black blue","name_zh": "Black blue","name_ja": "Black blue","hex": "#191E28"},{"ral": "RAL 5005","name_en": "Signal blue","name_zh": "信号蓝","name_ja": "Signal blue","hex": "#005387"},{"ral": "RAL 5007","name_en": "Brilliant blue","name_zh": "Brilliant blue","name_ja": "Brilliant blue","hex": "#376B8C"},{"ral": "RAL 5008","name_en": "Grey blue","name_zh": "Grey blue","name_ja": "Grey blue","hex": "#2B3A44"},{"ral": "RAL 5009","name_en": "Azure blue","name_zh": "Azure blue","name_ja": "Azure blue","hex": "#215F78"},{"ral": "RAL 5010","name_en": "Gentian blue","name_zh": "Gentian blue","name_ja": "Gentian blue","hex": "#004F7C"},{"ral": "RAL 5011","name_en": "Steel blue","name_zh": "Steel blue","name_ja": "Steel blue","hex": "#1A2B3C"},{"ral": "RAL 5012","name_en": "Light blue","name_zh": "Light blue","name_ja": "Light blue","hex": "#0089B6"},{"ral": "RAL 5013","name_en": "Cobalt blue","name_zh": "Cobalt blue","name_ja": "Cobalt blue","hex": "#193153"},{"ral": "RAL 5014","name_en": "Pigeon blue","name_zh": "Pigeon blue","name_ja": "Pigeon blue","hex": "#637D96"},{"ral": "RAL 5015","name_en": "Sky blue","name_zh": "Sky blue","name_ja": "Sky blue","hex": "#007CAF"},{"ral": "RAL 5017","name_en": "Traffic blue","name_zh": "Traffic blue","name_ja": "Traffic blue","hex": "#005B8C"},{"ral": "RAL 5018","name_en": "Turquoise blue","name_zh": "Turquoise blue","name_ja": "Turquoise blue","hex": "#048B8C"},{"ral": "RAL 5019","name_en": "Capri blue","name_zh": "Capri blue","name_ja": "Capri blue","hex": "#005E83"},{"ral": "RAL 5020","name_en": "Ocean blue","name_zh": "Ocean blue","name_ja": "Ocean blue","hex": "#00414B"},{"ral": "RAL 5021","name_en": "Water blue","name_zh": "Water blue","name_ja": "Water blue","hex": "#007577"},{"ral": "RAL 5022","name_en": "Night blue","name_zh": "Night blue","name_ja": "Night blue","hex": "#222D5A"},{"ral": "RAL 5023","name_en": "Distant blue","name_zh": "Distant blue","name_ja": "Distant blue","hex": "#41698C"},{"ral": "RAL 5024","name_en": "Pastel blue","name_zh": "Pastel blue","name_ja": "Pastel blue","hex": "#6093AC"},{"ral": "RAL 5025","name_en": "Pearl gentian blue","name_zh": "Pearl gentian blue","name_ja": "Pearl gentian blue","hex": "#20697C"},{"ral": "RAL 5026","name_en": "Pearl night blue","name_zh": "Pearl night blue","name_ja": "Pearl night blue","hex": "#0F3052"},{"ral": "RAL 6000","name_en": "Patina green","name_zh": "Patina green","name_ja": "Patina green","hex": "#3C7460"},{"ral": "RAL 6001","name_en": "Emerald green","name_zh": "Emerald green","name_ja": "Emerald green","hex": "#366735"},{"ral": "RAL 6002","name_en": "Leaf green","name_zh": "Leaf green","name_ja": "Leaf green","hex": "#325928"},{"ral": "RAL 6003","name_en": "Olive green","name_zh": "Olive green","name_ja": "Olive green","hex": "#50533C"},{"ral": "RAL 6004","name_en": "Blue green","name_zh": "Blue green","name_ja": "Blue green","hex": "#024442"},{"ral": "RAL 6005","name_en": "Moss green","name_zh": "Moss green","name_ja": "Moss green","hex": "#114232"},{"ral": "RAL 6006","name_en": "Grey olive","name_zh": "Grey olive","name_ja": "Grey olive","hex": "#3C392E"},{"ral": "RAL 6007","name_en": "Bottle green","name_zh": "Bottle green","name_ja": "Bottle green","hex": "#2C3222"},{"ral": "RAL 6008","name_en": "Brown green","name_zh": "Brown green","name_ja": "Brown green","hex": "#36342A"},{"ral": "RAL 6009","name_en": "Fir green","name_zh": "Fir green","name_ja": "Fir green","hex": "#27352A"},{"ral": "RAL 6010","name_en": "Grass green","name_zh": "Grass green","name_ja": "Grass green","hex": "#4D6F39"},{"ral": "RAL 6011","name_en": "Reseda green","name_zh": "Reseda green","name_ja": "Reseda green","hex": "#6B7C59"},{"ral": "RAL 6012","name_en": "Black green","name_zh": "Black green","name_ja": "Black green","hex": "#2F3D3A"},{"ral": "RAL 6013","name_en": "Reed green","name_zh": "Reed green","name_ja": "Reed green","hex": "#7C765A"},{"ral": "RAL 6014","name_en": "Yellow olive","name_zh": "Yellow olive","name_ja": "Yellow olive","hex": "#474135"},{"ral": "RAL 6015","name_en": "Black olive","name_zh": "Black olive","name_ja": "Black olive","hex": "#3D3D36"},{"ral": "RAL 6016","name_en": "Turquoise green","name_zh": "Turquoise green","name_ja": "Turquoise green","hex": "#00694C"},{"ral": "RAL 6017","name_en": "May green","name_zh": "May green","name_ja": "May green","hex": "#587F40"},{"ral": "RAL 6018","name_en": "Yellow green","name_zh": "Yellow green","name_ja": "Yellow green","hex": "#60993B"},{"ral": "RAL 6019","name_en": "Pastel green","name_zh": "Pastel green","name_ja": "Pastel green","hex": "#B9CEAC"},{"ral": "RAL 6020","name_en": "Chrome green","name_zh": "Chrome green","name_ja": "Chrome green","hex": "#37422F"},{"ral": "RAL 6021","name_en": "Pale green","name_zh": "Pale green","name_ja": "Pale green","hex": "#8A9977"},{"ral": "RAL 6022","name_en": "Olive drab","name_zh": "Olive drab","name_ja": "Olive drab","hex": "#3A3327"},{"ral": "RAL 6024","name_en": "Traffic green","name_zh": "Traffic green","name_ja": "Traffic green","hex": "#008351"},{"ral": "RAL 6025","name_en": "Fern green","name_zh": "Fern green","name_ja": "Fern green","hex": "#5E6E3B"},{"ral": "RAL 6026","name_en": "Opal green","name_zh": "Opal green","name_ja": "Opal green","hex": "#315442"},{"ral": "RAL 6027","name_en": "Light green","name_zh": "Light green","name_ja": "Light green","hex": "#7EBAB5"},{"ral": "RAL 6028","name_en": "Pine green","name_zh": "Pine green","name_ja": "Pine green","hex": "#315442"},{"ral": "RAL 6029","name_en": "Mint green","name_zh": "Mint green","name_ja": "Mint green","hex": "#006F3D"},{"ral": "RAL 6032","name_en": "Signal green","name_zh": "Signal green","name_ja": "Signal green","hex": "#0F7D4F"},{"ral": "RAL 7000","name_en": "Squirrel grey","name_zh": "Squirrel grey","name_ja": "Squirrel grey","hex": "#7B858A"},{"ral": "RAL 7001","name_en": "Silver grey","name_zh": "Silver grey","name_ja": "Silver grey","hex": "#8C979C"},{"ral": "RAL 7002","name_en": "Olive grey","name_zh": "Olive grey","name_ja": "Olive grey","hex": "#7E735F"},{"ral": "RAL 7003","name_en": "Moss grey","name_zh": "Moss grey","name_ja": "Moss grey","hex": "#7A7669"},{"ral": "RAL 7004","name_en": "Signal grey","name_zh": "Signal grey","name_ja": "Signal grey","hex": "#96918E"},{"ral": "RAL 7005","name_en": "Mouse grey","name_zh": "Mouse grey","name_ja": "Mouse grey","hex": "#6C6F6A"},{"ral": "RAL 7006","name_en": "Beige grey","name_zh": "Beige grey","name_ja": "Beige grey","hex": "#766A5E"},{"ral": "RAL 7008","name_en": "Khaki grey","name_zh": "Khaki grey","name_ja": "Khaki grey","hex": "#6C5D34"},{"ral": "RAL 7009","name_en": "Green grey","name_zh": "Green grey","name_ja": "Green grey","hex": "#5F6058"},{"ral": "RAL 7010","name_en": "Tarpaulin grey","name_zh": "Tarpaulin grey","name_ja": "Tarpaulin grey","hex": "#57595D"},{"ral": "RAL 7011","name_en": "Iron grey","name_zh": "Iron grey","name_ja": "Iron grey","hex": "#52595F"},{"ral": "RAL 7012","name_en": "Basalt grey","name_zh": "Basalt grey","name_ja": "Basalt grey","hex": "#575D5E"},{"ral": "RAL 7013","name_en": "Brown grey","name_zh": "Brown grey","name_ja": "Brown grey","hex": "#57534A"},{"ral": "RAL 7015","name_en": "Slate grey","name_zh": "Slate grey","name_ja": "Slate grey","hex": "#4F5358"},{"ral": "RAL 7016","name_en": "Anthracite grey","name_zh": "Anthracite grey","name_ja": "Anthracite grey","hex": "#373F43"},{"ral": "RAL 7021","name_en": "Black grey","name_zh": "Black grey","name_ja": "Black grey","hex": "#2F3435"},{"ral": "RAL 7022","name_en": "Umbra grey","name_zh": "Umbra grey","name_ja": "Umbra grey","hex": "#4B4D46"},{"ral": "RAL 7023","name_en": "Concrete grey","name_zh": "Concrete grey","name_ja": "Concrete grey","hex": "#79766B"},{"ral": "RAL 7024","name_en": "Graphite grey","name_zh": "Graphite grey","name_ja": "Graphite grey","hex": "#45494E"},{"ral": "RAL 7026","name_en": "Granite grey","name_zh": "Granite grey","name_ja": "Granite grey","hex": "#394146"},{"ral": "RAL 7030","name_en": "Stone grey","name_zh": "Stone grey","name_ja": "Stone grey","hex": "#908E85"},{"ral": "RAL 7031","name_en": "Blue grey","name_zh": "Blue grey","name_ja": "Blue grey","hex": "#5B686F"},{"ral": "RAL 7032","name_en": "Pebble grey","name_zh": "Pebble grey","name_ja": "Pebble grey","hex": "#B0AA94"},{"ral": "RAL 7033","name_en": "Cement grey","name_zh": "Cement grey","name_ja": "Cement grey","hex": "#7D7B6E"},{"ral": "RAL 7034","name_en": "Yellow grey","name_zh": "Yellow grey","name_ja": "Yellow grey","hex": "#928D6F"},{"ral": "RAL 7035","name_en": "Light grey","name_zh": "浅灰","name_ja": "Light grey","hex": "#C5C8C1"},{"ral": "RAL 7036","name_en": "Platinum grey","name_zh": "Platinum grey","name_ja": "Platinum grey","hex": "#979392"},{"ral": "RAL 7037","name_en": "Dusty grey","name_zh": "Dusty grey","name_ja": "Dusty grey","hex": "#797B7A"},{"ral": "RAL 7038","name_en": "Agate grey","name_zh": "Agate grey","name_ja": "Agate grey","hex": "#B4B0A5"},{"ral": "RAL 7039","name_en": "Quartz grey","name_zh": "Quartz grey","name_ja": "Quartz grey","hex": "#6B665E"},{"ral": "RAL 7040","name_en": "Window grey","name_zh": "Window grey","name_ja": "Window grey","hex": "#989EA1"},{"ral": "RAL 7042","name_en": "Traffic grey A","name_zh": "Traffic grey A","name_ja": "Traffic grey A","hex": "#8E9291"},{"ral": "RAL 7043","name_en": "Traffic grey B","name_zh": "Traffic grey B","name_ja": "Traffic grey B","hex": "#4D5052"},{"ral": "RAL 7044","name_en": "Silk grey","name_zh": "Silk grey","name_ja": "Silk grey","hex": "#BDBCAE"},{"ral": "RAL 7045","name_en": "Telegrey 1","name_zh": "Telegrey 1","name_ja": "Telegrey 1","hex": "#91969A"},{"ral": "RAL 7046","name_en": "Telegrey 2","name_zh": "Telegrey 2","name_ja": "Telegrey 2","hex": "#81898E"},{"ral": "RAL 7047","name_en": "Telegrey 4","name_zh": "Telegrey 4","name_ja": "Telegrey 4","hex": "#CFD0CB"},{"ral": "RAL 8000","name_en": "Green brown","name_zh": "Green brown","name_ja": "Green brown","hex": "#836D3D"},{"ral": "RAL 8001","name_en": "Ochre brown","name_zh": "Ochre brown","name_ja": "Ochre brown","hex": "#8D5B2D"},{"ral": "RAL 8002","name_en": "Signal brown","name_zh": "Signal brown","name_ja": "Signal brown","hex": "#79533D"},{"ral": "RAL 8003","name_en": "Clay brown","name_zh": "Clay brown","name_ja": "Clay brown","hex": "#7A4B27"},{"ral": "RAL 8004","name_en": "Copper brown","name_zh": "Copper brown","name_ja": "Copper brown","hex": "#794D3C"},{"ral": "RAL 8007","name_en": "Fawn brown","name_zh": "Fawn brown","name_ja": "Fawn brown","hex": "#6C4828"},{"ral": "RAL 8008","name_en": "Olive brown","name_zh": "Olive brown","name_ja": "Olive brown","hex": "#6A4D2A"},{"ral": "RAL 8011","name_en": "Nut brown","name_zh": "Nut brown","name_ja": "Nut brown","hex": "#5A3B2B"},{"ral": "RAL 8012","name_en": "Red brown","name_zh": "Red brown","name_ja": "Red brown","hex": "#673532"},{"ral": "RAL 8014","name_en": "Sepia brown","name_zh": "Sepia brown","name_ja": "Sepia brown","hex": "#4A352E"},{"ral": "RAL 8015","name_en": "Chestnut brown","name_zh": "Chestnut brown","name_ja": "Chestnut brown","hex": "#5A2F2A"},{"ral": "RAL 8016","name_en": "Mahogany brown","name_zh": "Mahogany brown","name_ja": "Mahogany brown","hex": "#4C2B20"},{"ral": "RAL 8017","name_en": "Chocolate brown","name_zh": "Chocolate brown","name_ja": "Chocolate brown","hex": "#442B26"},{"ral": "RAL 8019","name_en": "Grey brown","name_zh": "Grey brown","name_ja": "Grey brown","hex": "#3D3635"},{"ral": "RAL 8022","name_en": "Black brown","name_zh": "Black brown","name_ja": "Black brown","hex": "#1A1718"},{"ral": "RAL 8023","name_en": "Orange brown","name_zh": "Orange brown","name_ja": "Orange brown","hex": "#A45729"},{"ral": "RAL 8024","name_en": "Beige brown","name_zh": "Beige brown","name_ja": "Beige brown","hex": "#795440"},{"ral": "RAL 8025","name_en": "Pale brown","name_zh": "Pale brown","name_ja": "Pale brown","hex": "#735848"},{"ral": "RAL 8028","name_en": "Terra brown","name_zh": "Terra brown","name_ja": "Terra brown","hex": "#4F3B2B"},{"ral": "RAL 9001","name_en": "Cream","name_zh": "Cream","name_ja": "Cream","hex": "#E9E0D2"},{"ral": "RAL 9002","name_en": "Grey white","name_zh": "灰白","name_ja": "Grey white","hex": "#E7EBDA"},{"ral": "RAL 9003","name_en": "Signal white","name_zh": "Signal white","name_ja": "Signal white","hex": "#ECECE7"},{"ral": "RAL 9004","name_en": "Signal black","name_zh": "Signal black","name_ja": "Signal black","hex": "#2B2B2C"},{"ral": "RAL 9005","name_en": "Jet black","name_zh": "Jet black","name_ja": "Jet black","hex": "#0D0E10"},{"ral": "RAL 9006","name_en": "White aluminium","name_zh": "White aluminium","name_ja": "White aluminium","hex": "#A1A1A0"},{"ral": "RAL 9007","name_en": "Grey aluminium","name_zh": "Grey aluminium","name_ja": "Grey aluminium","hex": "#898C8B"},{"ral": "RAL 9010","name_en": "Pure white","name_zh": "Pure white","name_ja": "Pure white","hex": "#ECECE1"},{"ral": "RAL 9011","name_en": "Graphite black","name_zh": "Graphite black","name_ja": "Graphite black","hex": "#272C30"},{"ral": "RAL 9016","name_en": "Traffic white","name_zh": "Traffic white","name_ja": "Traffic white","hex": "#F1EEE5"},{"ral": "RAL 9017","name_en": "Traffic black","name_zh": "Traffic black","name_ja": "Traffic black","hex": "#272A2D"},{"ral": "RAL 9018","name_en": "Papyrus white","name_zh": "Papyrus white","name_ja": "Papyrus white","hex": "#CFD3CD"},{"ral": "RAL 9022","name_en": "Pearl light grey","name_zh": "Pearl light grey","name_ja": "Pearl light grey","hex": "#8C8F8E"},{"ral": "RAL 9023","name_en": "Pearl dark grey","name_zh": "Pearl dark grey","name_ja": "Pearl dark grey","hex": "#787D7E"}];

    document.addEventListener('DOMContentLoaded', () => {
        let paintChart, currentLanguage, currentState = {};
        const elements={ralSearch:document.getElementById("ralSearch"),ralSelect:document.getElementById("ralSelect"),colorSwatch:document.getElementById("colorSwatch"),currentRalCode:document.getElementById("currentRalCode"),currentHex:document.getElementById("currentHex"),volumeSelect:document.getElementById("volumeSelect"),paintSlidersContainer:document.getElementById("paintSlidersContainer"),totalPigmentWeight:document.getElementById("totalPigmentWeight"),scoopEstimate:document.getElementById("scoopEstimate"),varnishAmount:document.getElementById("varnishAmount"),perLiterAmount:document.getElementById("perLiterAmount"),mixingRatio:document.getElementById("mixingRatio"),addFormulaBtn:document.getElementById("addFormulaBtn"),resetFormulaBtn:document.getElementById("resetFormulaBtn"),paintChart:document.getElementById("paintChart"),notification:document.getElementById("notification"),recipePresetsContainer:document.getElementById("recipePresetsContainer"),searchSuggestions:document.getElementById("searchSuggestions"),canLabel:document.getElementById("canLabel"),canBody:document.getElementById("canBody"),exportRecipeBtn:document.getElementById('exportRecipeBtn'),copyRecipeBtn:document.getElementById('copyRecipeBtn'),shareRecipeBtn:document.getElementById('shareRecipeBtn'),generateRecipeBtn:document.getElementById('generateRecipeBtn'),ralPaletteContainer:document.getElementById('ralPaletteContainer')};
        const VOLUME_FACTORS={'500ml':0.5,'1l':1,'5l':5,'20l':20};
        const TOTAL_PIGMENT_PER_LITER=106;

        // Color Math Helpers
        const hexToRgb=hex=>{const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]:null};
        const rgbToXyz=(r,g,b)=>{r/=255;g/=255;b/=255;r=r>0.04045?((r+0.055)/1.055)**2.4:r/12.92;g=g>0.04045?((g+0.055)/1.055)**2.4:g/12.92;b=b>0.04045?((b+0.055)/1.055)**2.4:b/12.92;r*=100;g*=100;b*=100;return[r*0.4124+g*0.3576+b*0.1805,r*0.2126+g*0.7152+b*0.0722,r*0.0193+g*0.1192+b*0.9505]};
        const xyzToLab=(x,y,z)=>{x/=95.047;y/=100;z/=108.883;x=x>0.008856?x**(1/3):7.787*x+16/116;y=y>0.008856?y**(1/3):7.787*y+16/116;z=z>0.008856?z**(1/3):7.787*z+16/116;return[116*y-16,500*(x-y),200*(y-z)]};
        const hexToLab=hex=>xyzToLab(...rgbToXyz(...hexToRgb(hex)));

        // Pre-calculate Lab for all pigments
        Object.values(PAINT_DATA).forEach(p => { 
          if(p.manualLab) { p.lab = p.manualLab; }
          else if(p.hex) { p.lab = hexToLab(p.hex); }
          // Calculate Hue Angle (h) in Lab space: atan2(b, a)
          // Range: -PI to PI, convert to 0-360 degrees
          if(p.lab) {
             let angle = Math.atan2(p.lab[2], p.lab[1]) * 180 / Math.PI;
             if(angle < 0) angle += 360;
             p.hue = angle;
             p.chroma = Math.sqrt(p.lab[1]**2 + p.lab[2]**2);
          }
        });

        const showNotification = (message, type = 'success') => { elements.notification.textContent = message; elements.notification.className = `fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg transform transition-all z-50 text-sm ${type === 'error' ? 'bg-red-600 text-white' : 'bg-dark text-white'} translate-y-0 opacity-100`; setTimeout(() => elements.notification.classList.add('translate-y-24', 'opacity-0'), 3000); };
        const calculateTotals = () => { let total = 0; document.querySelectorAll('#paintSlidersContainer input[type="range"]').forEach(s => total += Number(s.value)); const factor = currentState.volumeFactor; const baseWeight = factor * 1000; elements.totalPigmentWeight.textContent = `${total.toFixed(1)}g`; elements.scoopEstimate.textContent = `(${currentLanguage === 'zh' ? '约' : ''}${Math.round(total / 50)}${currentLanguage === 'zh' ? '勺' : ' spoons'})`; elements.varnishAmount.textContent = `${currentState.volume.toUpperCase()}`; elements.perLiterAmount.textContent = factor > 0 ? `${(total / factor).toFixed(1)}g` : '0.0g'; const ratio = total > 0 ? Math.round((total / (total + baseWeight)) * 100) : 0; elements.mixingRatio.textContent = `${ratio} : ${100 - ratio}`; };
        const updatePaintChart = () => { if (!paintChart) return; const labels = [], data = [], colors = []; Object.keys(PAINT_DATA).forEach(code => { const weight = Number(document.getElementById(`slider${code}`)?.value || 0); if (weight > 0.05) { const paint = PAINT_DATA[code]; labels.push(`${paint[`name_${currentLanguage}`] || paint.name_en} (${weight.toFixed(1)}g)`); data.push(weight); const colorMap = { Y: '#F4C430', '0': '#FF7F00', R: '#B91D23', V: '#800080', B: '#2A58D1', G: '#229954', BK: '#000000', W: '#E0E0E0' }; colors.push(colorMap[code.charAt(0)] || '#CCCCCC'); } }); paintChart.data = { labels, datasets: [{ data, backgroundColor: colors, borderWidth: 1 }] }; paintChart.update(); };
        const resetAllSliders = (notify = false) => { document.querySelectorAll('#paintSlidersContainer input[type="range"]').forEach(s => { s.value = 0; s.disabled = false; s.classList.remove('bg-gray-300', 'cursor-not-allowed'); s.dispatchEvent(new Event('input', { bubbles: true })) }); if (notify) showNotification(currentLanguage === 'zh' ? '颜料已清空' : 'Pigments cleared'); };
        
        const updatePaintWeights = (baseRecipe) => { resetAllSliders(); const factor = currentState.volumeFactor; Object.keys(baseRecipe).forEach(code => { const value = (baseRecipe[code] / 100) * TOTAL_PIGMENT_PER_LITER * factor; const slider = document.getElementById(`slider${code}`); if (slider) { slider.value = value; slider.dispatchEvent(new Event('input', { bubbles: true })); } }); document.querySelectorAll('#paintSlidersContainer input[type="range"]').forEach(s => { s.disabled = true; s.classList.add('bg-gray-300', 'cursor-not-allowed'); }); };

        // ---------------------------------------------------------
        // New Algorithm: Hue-Luminance Pinpoint Approximation
        // ---------------------------------------------------------
        const generateReferenceRecipe = () => {
            if (!currentState.ral) {
                showNotification("zh" === currentLanguage ? "请先选择一个RAL颜色" : "Select a RAL color first", "error");
                return;
            }

            const targetLab = hexToLab(currentState.ral.hex);
            let targetAngle = Math.atan2(targetLab[2], targetLab[1]) * 180 / Math.PI;
            if(targetAngle < 0) targetAngle += 360;
            const targetL = targetLab[0];
            const targetChroma = Math.sqrt(targetLab[1]**2 + targetLab[2]**2);

            let recipe = {};
            let usedPigments = [];

            // 1. Special Handling: Very Low Chroma (Greys/Whites/Blacks)
            // If chroma < 10, it's basically Achromatic
            if(targetChroma < 10) {
                 if(targetL > 90) {
                     recipe.W064 = 98; // Mostly White
                     // Tiny bit of black or complementary to kill chroma, simplified to black here
                     recipe.BK7H = (100 - targetL) * 0.5; 
                 } else {
                     // Grey scale
                     recipe.W064 = (targetL / 100) * 80;
                     recipe.BK7H = ((100 - targetL) / 100) * 40 / (PAINT_DATA.BK7H.strength || 1);
                 }
            } else {
                // 2. Chromatic Handling: Find Angle Neighbors
                // We need to find two pigments: P1 < TargetAngle < P2
                const chromatic = Object.entries(PAINT_DATA).filter(([code, p]) => 
                    code !== 'W064' && code !== 'BK7H' && p.chroma > 20
                ).map(([code, p]) => ({code, hue: p.hue, data: p}));

                // Sort by hue
                chromatic.sort((a, b) => a.hue - b.hue);

                let p1 = null, p2 = null;
                // Find bracketing pigments
                for(let i=0; i<chromatic.length; i++) {
                    let current = chromatic[i];
                    let next = chromatic[(i + 1) % chromatic.length];
                    
                    // Handle the wrap-around 360->0 case
                    let h1 = current.hue;
                    let h2 = next.hue;
                    if (h2 < h1) h2 += 360; 
                    
                    let tHue = targetAngle;
                    if(tHue < h1 && (h1 - tHue > 180)) tHue += 360; // Adjust target for wrap-around

                    if(tHue >= h1 && tHue <= h2) {
                        p1 = current;
                        p2 = next;
                        break;
                    }
                }
                
                // Fallback (shouldn't happen with full spectrum, but just in case)
                if(!p1) { p1 = chromatic[0]; p2 = chromatic[1]; }

                // 3. Hue Interpolation
                // How close is target to P1 vs P2?
                // ratio = (Target - P1) / (P2 - P1)
                let h1 = p1.hue;
                let h2 = p2.hue;
                if (h2 < h1) h2 += 360;
                let tHue = targetAngle;
                if (tHue < h1) tHue += 360;
                
                let ratio = (tHue - h1) / (h2 - h1); // 0 means P1, 1 means P2
                
                // Base amount for Chromatic part (e.g. 50g total)
                let chromaticBase = 50; 
                
                // Strength Correction for Chromatic Mixing
                // If P1 is strong, we need less of it to achieve the hue influence
                let w1 = (1 - ratio) / (p1.data.strength || 1);
                let w2 = ratio / (p2.data.strength || 1);
                
                recipe[p1.code] = chromaticBase * (w1 / (w1 + w2));
                recipe[p2.code] = chromaticBase * (w2 / (w1 + w2));

                // 4. Luminance Correction
                // Calculate estimated L of the current mix
                let currentL = (p1.data.lab[0] * (1-ratio)) + (p2.data.lab[0] * ratio);
                
                if(targetL > currentL) {
                    // Need to lighten -> Add White
                    let diff = targetL - currentL;
                    // White is weak, needs multiplier
                    recipe.W064 = diff * 3.0 / (PAINT_DATA.W064.strength); 
                } else {
                    // Need to darken -> Add Black
                    let diff = currentL - targetL;
                    // Black is strong
                    recipe.BK7H = diff * 0.5 / (PAINT_DATA.BK7H.strength);
                }
            }

            // 5. Final Normalize
            let finalTotal = 0;
            Object.values(recipe).forEach(v => finalTotal += v);
            
            const finalRecipe = {};
            Object.entries(recipe).forEach(([k, v]) => {
                if (v > 0.1) {
                    finalRecipe[k] = (v / finalTotal) * 100;
                }
            });

            currentState.ral.baseRecipe = finalRecipe;
            updatePaintWeights(finalRecipe);
            showNotification("zh" === currentLanguage ? "已应用色相定点-亮度拟合算法" : "Recipe generated using Hue-Luminance approximation");
        };
        
        const updateColorDisplay = (ralData) => { if (!ralData || !ralData.ral) return; currentState.ral = ralData; const nameKey = `name_${currentLanguage}`; elements.colorSwatch.style.backgroundColor = ralData.hex; elements.currentRalCode.textContent = ` ${ralData.ral} (${ralData[nameKey] || ralData.name_en})`; elements.currentHex.textContent = ` ${ralData.hex.toUpperCase()}`; elements.canLabel.textContent = ralData.ral; elements.canBody.style.backgroundColor = ralData.hex; };
        
        const switchLanguage = (lang) => {
            currentLanguage = lang; document.documentElement.lang = lang === 'zh' ? 'zh-CN' : lang;
            Object.entries(TRANSLATIONS[lang]).forEach(([key, value]) => {
                document.querySelectorAll(`[data-i18n="${key}"]`).forEach(el => {
                    const child = el.children[0];
                    if (key === 'recipe_includes_list') { el.innerHTML = value; }
                    else if (child && (child.nodeName === 'SPAN' || child.nodeName === 'STRONG')) {
                        let textNode = el.firstChild;
                        while(textNode && textNode.nodeType !== 3) { textNode = textNode.nextSibling; }
                        if (textNode) { textNode.nodeValue = value.endsWith(':') ? `${value} ` : value; }
                        else { el.insertBefore(document.createTextNode(value.endsWith(':')? `${value} `: value), child); }
                    } else { el.textContent = value; }
                });
                document.querySelectorAll(`[data-i18n-placeholder="${key}"]`).forEach(el => el.placeholder = value);
            });
            document.querySelectorAll('.lang-btn').forEach(b => b.classList.toggle('active', b.dataset.lang === lang));
            Object.keys(PAINT_DATA).forEach(code => { const el = document.querySelector(`[data-i18n-paint-name="${code}"]`); if (el) el.textContent = `${PAINT_DATA[code][`name_${lang}`] || PAINT_DATA[code].name_en} (${code})`; });
            initRalSelect(); initRecipePresets(); initRalPalette();
            if (currentState.ral && currentState.ral.ral !== 'RAL') updateColorDisplay(currentState.ral);
        };
        const initUI = () => { const getPaintColor = (code) => {const map={Y:'#F4C430','0':'#FF7F00',R:'#B91D23',V:'#800080',B:'#2A58D1',G:'#229954',BK:'#000000',W:'#FFFFFF'};return map[code.charAt(0)]||'#CCCCCC';}; elements.paintSlidersContainer.innerHTML = Object.entries(PAINT_DATA).map(([code, paint]) => `<div class="space-y-1"><div class="flex items-center justify-between mb-1"><label for="slider${code}" class="text-sm text-gray-700 flex items-center"><span class="paint-dot" style="background-color:${getPaintColor(code)};border-color:${code==='W064'?'#ccc':'transparent'}"></span><span data-i18n-paint-name="${code}"></span></label><div class="flex items-center gap-1"><span id="value${code}" class="weight-display text-gray-800 text-xs font-mono min-w-[40px] text-right pr-1">0.0g</span></div></div><input type="range" id="slider${code}" min="0" max="${TOTAL_PIGMENT_PER_LITER*VOLUME_FACTORS['20l']}" value="0" data-paint="${code}" step="0.1"></div>`).join(''); initPaintChart(); };
        const initRalSelect = () => { const selVal = elements.ralSelect.value; elements.ralSelect.innerHTML = `<option value="">${TRANSLATIONS[currentLanguage].select_ral_code}</option>`; const grouped = ralPaintMap.reduce((acc, c) => { const group = c.ral.split(" ")[1].charAt(0); if (!acc[group]) acc[group] = []; acc[group].push(c); return acc; }, {}); Object.keys(grouped).sort().forEach(group => { const optgroup = document.createElement('optgroup'); optgroup.label = `RAL ${group}000 Series`; grouped[group].sort((a,b) => a.ral.localeCompare(b.ral, undefined, {numeric: true})).forEach(color => { const option = document.createElement('option'); option.value = color.ral; option.textContent = `${color.ral} - ${color[`name_${currentLanguage}`] || color.name_en}`; optgroup.appendChild(option); }); elements.ralSelect.appendChild(optgroup); }); elements.ralSelect.value = selVal; };
        const initRecipePresets = () => { elements.recipePresetsContainer.innerHTML = ralPaintMap.filter(c => c.baseRecipe).map(data => `<button class="recipe-preset bg-white border border-gray-200 rounded-lg p-2 text-center text-xs hover:border-primary hover:bg-primary/5 transition-all duration-200" data-ral="${data.ral}"><div class="w-full h-8 rounded mb-1" style="background-color: ${data.hex};"></div><div class="font-medium">${data[`name_${currentLanguage}`] || data.name_en}</div><div class="text-xs text-gray-500">${data.ral}</div></button>`).join(''); };
        const initRalPalette = () => { elements.ralPaletteContainer.innerHTML = ralPaintMap.map(data => `<button class="ral-palette bg-white border border-gray-200 rounded-lg p-2 text-center text-xs hover:border-primary hover:bg-primary/5 transition-all duration-200" data-ral="${data.ral}"><div class="w-full h-8 rounded mb-1" style="background-color: ${data.hex};"></div><div class="font-medium">${data[`name_${currentLanguage}`] || data.name_en}</div><div class="text-xs text-gray-500">${data.ral}</div></button>`).join(''); };
        const initPaintChart = () => { if (paintChart) paintChart.destroy(); const ctx = elements.paintChart.getContext('2d'); paintChart = new Chart(ctx, { type: 'doughnut', data: { datasets: [{ borderWidth: 1 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } } }); };
        
        const getTotalPigment = () => { let total = 0; document.querySelectorAll('#paintSlidersContainer input[type="range"]').forEach(s => total += Number(s.value)); return total; };
        const getRecipeText = (detailed = false) => { let text = `${currentState.ral?.ral || 'Custom'} Recipe\nHex: ${currentState.ral?.hex?.toUpperCase() || 'N/A'}\nVolume: ${currentState.volume.toUpperCase()}\n\nPigments:\n`; Object.keys(PAINT_DATA).forEach(code => { const weight = Number(document.getElementById(`slider${code}`)?.value || 0); if (weight > 0) text += `- ${PAINT_DATA[code][`name_${currentLanguage}`] || PAINT_DATA[code].name_en} (${code}): ${weight.toFixed(1)}g\n`; }); text += `\nTotal Pigment: ${getTotalPigment().toFixed(1)}g\nBase: ${currentState.volume.toUpperCase()}\nRatio: ${elements.mixingRatio.textContent}`; if (detailed) text += `\n\nGenerated by MooCow Mini on ${new Date().toLocaleString()}`; return text; };
        const exportRecipe = () => { if (getTotalPigment() === 0) { showNotification(currentLanguage === 'zh' ? '无配方可导出' : 'No recipe to export', 'error'); return; } const recipeText = getRecipeText(true); const blob = new Blob([recipeText], { type: 'text/plain' }); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = `${currentState.ral?.ral || 'Recipe'}.txt`; a.click(); URL.revokeObjectURL(url); showNotification(currentLanguage === 'zh' ? '配方已导出' : 'Recipe exported'); };
        const copyRecipe = async () => { if (getTotalPigment() === 0) { showNotification(currentLanguage === 'zh' ? '无配方可复制' : 'No recipe to copy', 'error'); return; } const recipeText = getRecipeText(); try { await navigator.clipboard.writeText(recipeText); showNotification(currentLanguage === 'zh' ? '配方已复制' : 'Recipe copied'); } catch { showNotification(currentLanguage === 'zh' ? '复制失败' : 'Copy failed', 'error'); } };
        const shareRecipe = async () => { if (getTotalPigment() === 0) { showNotification(currentLanguage === 'zh' ? '无配方可分享' : 'No recipe to share', 'error'); return; } const recipeText = getRecipeText(); if (navigator.share) { try { await navigator.share({ title: currentState.ral?.ral || 'MooCow Recipe', text: recipeText }); showNotification(currentLanguage === 'zh' ? '分享成功' : 'Shared successfully'); } catch { showNotification(currentLanguage === 'zh' ? '分享失败' : 'Share failed', 'error'); } } else { await copyRecipe(); showNotification(currentLanguage === 'zh' ? '不支持分享，已复制' : 'Share not supported, copied instead'); } };
        elements.ralSelect.addEventListener('change', e => { const data = ralPaintMap.find(c => c.ral === e.target.value); if (data) { updateColorDisplay(data); if (data.baseRecipe) { updatePaintWeights(data.baseRecipe); } else { resetAllSliders(); } }});
        elements.volumeSelect.addEventListener('change', () => { currentState.volume = elements.volumeSelect.value; currentState.volumeFactor = VOLUME_FACTORS[currentState.volume]; if (currentState.ral && currentState.ral.baseRecipe) { updatePaintWeights(currentState.ral.baseRecipe); } calculateTotals(); });
        elements.resetFormulaBtn.addEventListener('click', () => resetAllSliders(true));
        elements.addFormulaBtn.addEventListener('click', () => { let hasRecipe = false; document.querySelectorAll('#paintSlidersContainer input[type="range"]').forEach(slider => { const currentValue = Number(slider.value); if (currentValue > 0) { hasRecipe = true; slider.value = currentValue * 1.05; slider.dispatchEvent(new Event('input', { bubbles: true })); } }); if (hasRecipe) { showNotification(currentLanguage === 'zh' ? '配方已微调 (+5%)' : 'Formula adjusted (+5%)'); } else { showNotification(currentLanguage === 'zh' ? '请先加载配方或手动输入颜料' : 'Load or enter a recipe first', 'error'); } });
        elements.generateRecipeBtn.addEventListener('click', generateReferenceRecipe);
        document.querySelectorAll('.lang-btn').forEach(b => b.addEventListener('click', () => switchLanguage(b.dataset.lang)));
        elements.paintSlidersContainer.addEventListener('input', e => { if (e.target.type === 'range') { const code = e.target.dataset.paint; document.getElementById(`value${code}`).textContent = `${Number(e.target.value).toFixed(1)}g`; calculateTotals(); updatePaintChart(); } });
        elements.recipePresetsContainer.addEventListener('click', e => { const btn = e.target.closest('.recipe-preset'); if (!btn) return; const data = ralPaintMap.find(c => c.ral === btn.dataset.ral); if(data) { elements.ralSelect.value = data.ral; updateColorDisplay(data); updatePaintWeights(data.baseRecipe); } });
        elements.ralSearch.addEventListener('input', e => { const term = e.target.value.toLowerCase(); if(!term){elements.searchSuggestions.classList.add('hidden');return;} const results=ralPaintMap.filter(c=>c.ral.toLowerCase().includes(term)||c.name_en.toLowerCase().includes(term)||(c.name_zh&&c.name_zh.includes(term))); elements.searchSuggestions.innerHTML=results.slice(0,5).map(c=>`<div class="p-2 hover:bg-gray-100 cursor-pointer" data-ral="${c.ral}">${c.ral} - ${c[`name_${currentLanguage}`] || c.name_en}</div>`).join(''); elements.searchSuggestions.classList.remove('hidden'); });
        elements.searchSuggestions.addEventListener('click', e => { const el = e.target.closest('[data-ral]'); if(!el) return; const data = ralPaintMap.find(c => c.ral === el.dataset.ral); if(data) { elements.ralSelect.value = data.ral; elements.ralSelect.dispatchEvent(new Event('change')); elements.searchSuggestions.classList.add('hidden'); elements.ralSearch.value='';} });
        document.addEventListener('click', e => { if (!elements.ralSearch.parentElement.contains(e.target)) elements.searchSuggestions.classList.add('hidden');});
        
        elements.exportRecipeBtn.addEventListener('click', exportRecipe);
        elements.copyRecipeBtn.addEventListener('click', copyRecipe);
        elements.shareRecipeBtn.addEventListener('click', shareRecipe);
        
        elements.ralPaletteContainer.addEventListener('click', e => { const btn = e.target.closest('.ral-palette'); if (!btn) return; const data = ralPaintMap.find(c => c.ral === btn.dataset.ral); if(data) { elements.ralSelect.value = data.ral; elements.ralSelect.dispatchEvent(new Event('change')); } });
        
        currentState = { ral: null, volume: '1l', volumeFactor: 1 };
        initUI();
        switchLanguage(localStorage.getItem('moocow_language') || 'zh');
        updateColorDisplay({ral:'RAL', name_zh:'未选择', name_en:'None', hex:'#FFFFFF'});
        resetAllSliders();
    });
  </script>
</body>
</html>