<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MooCow Mini èª¿è‰²ãƒ„ãƒ¼ãƒ« / Color Mixing Tool / è°ƒè‰²å·¥å…· v6.4 (ä¿®å¤ä¼˜åŒ–ç‰ˆ)</title>
<style>
/* ======================== CSS æ ·å¼ ======================== */
body {font-family: 'Segoe UI', 'Yu Gothic', 'Hiragino Sans', Tahoma, Geneva, Verdana, sans-serif;margin: 0;padding: 10px;background-color: #f4f4f4;color: #333;transition: all 0.3s ease;font-size: 14px;}
.container {max-width: 1200px;margin: auto;background: #fff;padding: 20px;border-radius: 12px;box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);}
.header {display: flex;justify-content: space-between;align-items: center;margin-bottom: 20px;border-bottom: 3px solid #3498db;padding-bottom: 10px;flex-wrap: wrap;gap: 10px;}
h1 {color: #2c3e50;margin: 0;flex: 1;font-size: 1.5em;min-width: 200px;}
.language-switcher {display: flex;gap: 6px;align-items: center;flex-shrink: 0;}
.lang-btn {padding: 8px 12px;border: 2px solid #3498db;background: transparent;color: #3498db;border-radius: 6px;cursor: pointer;font-weight: bold;transition: all 0.3s;font-size: 0.85em;min-width: 45px;text-align: center;}
.lang-btn.active {background: #3498db;color: white;}
.lang-btn:hover {background: #2980b9;color: white;border-color: #2980b9;}
.input-section {display: grid;grid-template-columns: 1fr 1fr 1fr;gap: 15px;margin-bottom: 20px;}
.input-group, .display-area {margin-bottom: 20px;padding: 15px;border: 1px solid #ddd;border-radius: 8px;background: #fafafa;}
label {display: block;margin-bottom: 8px;font-weight: bold;color: #34495e;font-size: 0.9em;}
.input-container {position: relative;display: flex;gap: 10px;}
#ralInput {flex: 1;padding: 12px;font-size: 1em;border: 2px solid #ccc;border-radius: 6px;transition: border-color 0.3s;min-height: 20px;}
#ralInput:focus {border-color: #3498db;outline: none;}
#ralSelect, #volumeSelect {flex: 1;padding: 12px;font-size: 1em;border: 2px solid #ccc;border-radius: 6px;background: white;cursor: pointer;min-height: 44px;}
#ralSelect:focus, #volumeSelect:focus {border-color: #3498db;outline: none;}
#colorPreview {height: 80px;border: 1px solid #ccc;border-radius: 6px;margin-top: 10px;transition: background-color 0.5s;display: flex;align-items: center;justify-content: center;font-size: 1em;color: #fff;text-shadow: 0 0 5px #000;font-weight: bold;}
.color-palette {margin-bottom: 20px;padding: 15px;border: 1px solid #ddd;border-radius: 8px;background: #fafafa;}
.color-palette h3 {margin-top: 0;margin-bottom: 15px;color: #2c3e50;font-size: 1.1em;}
.color-grid {display: grid;grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));gap: 6px;max-height: 300px;overflow-y: auto;padding: 10px;border: 1px solid #eee;border-radius: 6px;background: white;}
.color-swatch {width: 100%;height: 50px;border: 2px solid #ddd;border-radius: 6px;cursor: pointer;transition: all 0.3s;position: relative;display: flex;align-items: center;justify-content: center;font-size: 9px;font-weight: bold;text-shadow: 0 0 3px rgba(0,0,0,0.8);color: white;min-height: 50px;}
.color-swatch:hover {transform: scale(1.05);border-color: #3498db;box-shadow: 0 2px 8px rgba(0,0,0,0.3);z-index: 10;}
.color-swatch.selected {border-color: #e74c3c;border-width: 3px;transform: scale(1.02);}
.color-swatch .tooltip {position: absolute;bottom: -35px;left: 50%;transform: translateX(-50%);background: rgba(0,0,0,0.9);color: white;padding: 4px 8px;border-radius: 4px;font-size: 10px;white-space: nowrap;opacity: 0;pointer-events: none;transition: opacity 0.3s;z-index: 20;max-width: 120px;text-align: center;}
.color-swatch:hover .tooltip {opacity: 1;}
.details-grid {display: grid;grid-template-columns: 1fr 1fr;gap: 15px;margin-top: 15px;}
.detail-item {padding: 10px;background: #ecf0f1;border-radius: 4px;}
.detail-item strong {display: block;color: #2c3e50;}
#recipeList {list-style: none;padding: 0;}
#recipeList li {padding: 8px 0;border-bottom: 1px dashed #ddd;display: flex;justify-content: space-between;align-items: center;}
#recipeList li:last-child {border-bottom: none;}
.paint-weight {font-weight: bold;color: #27ae60;}
.paint-weight-grams {font-weight: bold;color: #e67e22;font-size: 1.1em;}
.error-message {color: #e74c3c;font-weight: bold;text-align: center;margin-top: 20px;}
.volume-info {background: #e8f5e8;border: 2px solid #27ae60;border-radius: 8px;padding: 12px;margin-top: 10px;text-align: center;}
.volume-info h4 {margin: 0 0 8px 0;color: #27ae60;font-size: 1em;}
.volume-display {font-size: 1.1em;font-weight: bold;color: #2c3e50;}
.color-difference {margin-top: 20px;padding: 15px;border: 1px solid #ddd;border-radius: 8px;background: #f8f9fa;}
.color-difference h3 {margin-top: 0;margin-bottom: 15px;color: #2c3e50;font-size: 1.1em;}
.comparison-section {display: grid;grid-template-columns: 1fr 1fr;gap: 15px;margin-bottom: 15px;}
.color-input-group {padding: 10px;border: 1px solid #ddd;border-radius: 6px;background: white;}
.color-input-group label {font-size: 0.9em;margin-bottom: 5px;}
.color-input-group input {width: 100%;padding: 8px;border: 1px solid #ccc;border-radius: 4px;font-size: 0.9em;}
.color-preview-small {width: 100%;height: 40px;border: 1px solid #ccc;border-radius: 4px;margin-top: 5px;display: flex;align-items: center;justify-content: center;font-size: 0.8em;font-weight: bold;color: white;text-shadow: 0 0 3px #000;}
.delta-e-result {text-align: center;padding: 15px;border-radius: 8px;font-weight: bold;font-size: 1.2em;}
.delta-e-excellent {background: #d4edda;color: #155724;border: 1px solid #c3e6cb;}
.delta-e-good {background: #fff3cd;color: #856404;border: 1px solid #ffeaa7;}
.delta-e-poor {background: #f8d7da;color: #721c24;border: 1px solid #f5c6cb;}
.delta-e-info {margin-top: 10px;font-size: 0.85em;color: #6c757d;text-align: center;}
.hidden {display: none !important;}
.debug-info {background: #f8f9fa;border: 1px solid #dee2e6;border-radius: 4px;padding: 10px;margin-top: 10px;font-family: monospace;font-size: 11px;max-height: 200px;overflow-y: auto;}
.btn {padding: 8px 16px;border: none;border-radius: 6px;cursor: pointer;font-weight: bold;transition: all 0.3s;font-size: 0.9em;}
.btn-primary {background: #3498db;color: white;}
.btn-primary:hover {background: #2980b9;}
.btn-secondary {background: #95a5a6;color: white;}
.btn-secondary:hover {background: #7f8c8d;}
@media (max-width: 768px) {body {padding: 5px;font-size: 13px;}.container {padding: 15px;border-radius: 8px;}.header {flex-direction: column;gap: 10px;text-align: center;margin-bottom: 15px;}h1 {font-size: 1.3em;min-width: auto;text-align: center;}.language-switcher {gap: 4px;justify-content: center;}.lang-btn {padding: 6px 10px;font-size: 0.8em;min-width: 40px;}.input-section {grid-template-columns: 1fr;gap: 10px;margin-bottom: 15px;}.input-group {padding: 12px;margin-bottom: 15px;}label {font-size: 0.85em;margin-bottom: 6px;}#ralInput, #ralSelect, #volumeSelect {padding: 10px;font-size: 0.9em;min-height: 40px;}#colorPreview {height: 60px;font-size: 0.9em;margin-top: 8px;}.volume-info {padding: 10px;margin-top: 8px;}.volume-info h4 {font-size: 0.9em;margin-bottom: 6px;}.volume-display {font-size: 1em;}.color-palette {padding: 12px;margin-bottom: 15px;}.color-palette h3 {font-size: 1em;margin-bottom: 10px;}.color-grid {grid-template-columns: repeat(6, 1fr);gap: 4px;max-height: 250px;padding: 8px;}.color-swatch {height: 40px;font-size: 8px;min-height: 40px;}.color-swatch .tooltip {font-size: 9px;padding: 3px 6px;bottom: -30px;}.details-grid {grid-template-columns: 1fr;gap: 10px;}.detail-item {padding: 8px;}.comparison-section {grid-template-columns: 1fr;gap: 10px;}.color-input-group {padding: 8px;}.color-preview-small {height: 35px;font-size: 0.75em;}.delta-e-result {padding: 12px;font-size: 1.1em;}.delta-e-info {font-size: 0.8em;}#recipeList li {flex-direction: column;align-items: flex-start;gap: 5px;padding: 10px 0;}.paint-weight-grams {font-size: 1em;}}
@media (max-width: 480px) {body {padding: 3px;font-size: 12px;}.container {padding: 10px;}h1 {font-size: 1.2em;}.lang-btn {padding: 5px 8px;font-size: 0.75em;min-width: 35px;}.color-grid {grid-template-columns: repeat(5, 1fr);gap: 3px;}.color-swatch {height: 35px;font-size: 7px;min-height: 35px;}#ralInput, #ralSelect, #volumeSelect {padding: 8px;font-size: 0.85em;}#colorPreview {height: 50px;font-size: 0.8em;}}
.color-grid::-webkit-scrollbar {width: 6px;}
.color-grid::-webkit-scrollbar-track {background: #f1f1f1;border-radius: 3px;}
.color-grid::-webkit-scrollbar-thumb {background: #888;border-radius: 3px;}
.color-grid::-webkit-scrollbar-thumb:hover {background: #555;}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1><span class="zh">ğŸ¨ MooCow Mini è°ƒè‰²å·¥å…· v6.4 (ä¿®å¤ä¼˜åŒ–ç‰ˆ)</span><span class="en hidden">ğŸ¨ MooCow Mini Color Mixing Tool v6.4 (Fixed)</span><span class="ja hidden">ğŸ¨ MooCow Mini èª¿è‰²ãƒ„ãƒ¼ãƒ« v6.4 (ä¿®æ­£ç‰ˆ)</span></h1>
<div class="language-switcher">
<button class="lang-btn active" onclick="switchLanguage('zh')">ä¸­æ–‡</button>
<button class="lang-btn" onclick="switchLanguage('en')">EN</button>
<button class="lang-btn" onclick="switchLanguage('ja')">æ—¥æœ¬èª</button>
</div>
</div>

<div class="input-section">
<div class="input-group">
<label for="ralInput"><span class="zh">è¾“å…¥ RAL è‰²å· (ä¾‹å¦‚: 3020)</span><span class="en hidden">Enter RAL Color Code (e.g.: 3020)</span><span class="ja hidden">RALè‰²ç•ªå·ã‚’å…¥åŠ› (ä¾‹: 3020)</span></label>
<div class="input-container">
<input type="text" id="ralInput" placeholder="">
</div>
<div id="colorPreview"><span class="zh">è¾“å…¥è‰²å·æˆ–é€‰æ‹©è‰²å—è¿›è¡ŒæŸ¥è¯¢</span><span class="en hidden">Enter color code or select color swatch</span><span class="ja hidden">è‰²ç•ªå·ã‚’å…¥åŠ›ã™ã‚‹ã‹è‰²è¦‹æœ¬ã‚’é¸æŠ</span></div>
</div>

<div class="input-group">
<label for="ralSelect"><span class="zh">æˆ–ä»ä¸‹æ‹‰èœå•é€‰æ‹© RAL è‰²å·</span><span class="en hidden">Or select RAL color code from dropdown</span><span class="ja hidden">ã¾ãŸã¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‹ã‚‰RALè‰²ç•ªå·ã‚’é¸æŠ</span></label>
<select id="ralSelect">
<option value=""><span class="zh">è¯·é€‰æ‹© RAL è‰²å·...</span><span class="en hidden">Please select RAL color code...</span><span class="ja hidden">RALè‰²ç•ªå·ã‚’é¸æŠã—ã¦ãã ã•ã„...</span></option>
</select>
</div>

<div class="input-group">
<label for="volumeSelect"><span class="zh">é€‰æ‹©é€æ˜åŸºç¡€æ¼†å®¹é‡</span><span class="en hidden">Select Clear Base Volume</span><span class="ja hidden">ã‚¯ãƒªã‚¢ãƒ™ãƒ¼ã‚¹å®¹é‡ã‚’é¸æŠ</span></label>
<select id="volumeSelect">
<option value="500">500ml</option>
<option value="1000" selected>1L (1000ml)</option>
<option value="5000">5L (5000ml)</option>
<option value="20000">20L (20000ml)</option>
</select>
<div class="volume-info">
<h4><span class="zh">ğŸ¯ é€‰å®šå®¹é‡</span><span class="en hidden">ğŸ¯ Selected Volume</span><span class="ja hidden">ğŸ¯ é¸æŠå®¹é‡</span></h4>
<div class="volume-display" id="volumeDisplay">1L (1000ml)</div>
</div>
</div>
</div>

<div class="color-palette">
<h3><span class="zh">ğŸ¨ RAL è‰²å¡é€‰æ‹© (ç‚¹å‡»è‰²å—å¿«é€Ÿé€‰æ‹©)</span><span class="en hidden">ğŸ¨ RAL Color Palette (Click color swatch to select)</span><span class="ja hidden">ğŸ¨ RAL ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ (è‰²è¦‹æœ¬ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ)</span></h3>
<div class="color-grid" id="colorGrid"></div>
</div>

<div class="color-difference">
<h3><span class="zh">ğŸ”¬ è‰²å·®è®¡ç®— (Delta E)</span><span class="en hidden">ğŸ”¬ Color Difference Calculation (Delta E)</span><span class="ja hidden">ğŸ”¬ è‰²å·®è¨ˆç®— (Delta E)</span></h3>
<div class="comparison-section">
<div class="color-input-group">
<label><span class="zh">ç›®æ ‡é¢œè‰² (LABå€¼)</span><span class="en hidden">Target Color (LAB Values)</span><span class="ja hidden">ç›®æ¨™è‰² (LABå€¤)</span></label>
<input type="number" id="targetL" placeholder="L (0-100)" style="margin-bottom: 5px;" min="0" max="100" step="0.01">
<input type="number" id="targetA" placeholder="a (-128 to 127)" style="margin-bottom: 5px;" min="-128" max="127" step="0.01">
<input type="number" id="targetB" placeholder="b (-128 to 127)" min="-128" max="127" step="0.01">
<div class="color-preview-small" id="targetColorPreview"><span class="zh">ç›®æ ‡é¢œè‰²</span><span class="en hidden">Target Color</span><span class="ja hidden">ç›®æ¨™è‰²</span></div>
</div>
<div class="color-input-group">
<label><span class="zh">å®é™…é¢œè‰² (LABå€¼)</span><span class="en hidden">Actual Color (LAB Values)</span><span class="ja hidden">å®Ÿéš›ã®è‰² (LABå€¤)</span></label>
<input type="number" id="actualL" placeholder="L (0-100)" style="margin-bottom: 5px;" min="0" max="100" step="0.01">
<input type="number" id="actualA" placeholder="a (-128 to 127)" style="margin-bottom: 5px;" min="-128" max="127" step="0.01">
<input type="number" id="actualB" placeholder="b (-128 to 127)" min="-128" max="127" step="0.01">
<div class="color-preview-small" id="actualColorPreview"><span class="zh">å®é™…é¢œè‰²</span><span class="en hidden">Actual Color</span><span class="ja hidden">å®Ÿéš›ã®è‰²</span></div>
</div>
</div>
<div style="text-align: center; margin-bottom: 15px;">
<button class="btn btn-primary" onclick="calculateDeltaE()"><span class="zh">è®¡ç®—è‰²å·®</span><span class="en hidden">Calculate Delta E</span><span class="ja hidden">è‰²å·®ã‚’è¨ˆç®—</span></button>
<button class="btn btn-secondary" onclick="useCurrentColor()"><span class="zh">ä½¿ç”¨å½“å‰é¢œè‰²</span><span class="en hidden">Use Current Color</span><span class="ja hidden">ç¾åœ¨ã®è‰²ã‚’ä½¿ç”¨</span></button>
</div>
<div id="deltaEResult" class="delta-e-result hidden">
<div id="deltaEValue"></div>
<div class="delta-e-info" id="deltaEInfo"></div>
</div>
</div>

<div id="colorDisplay" class="display-area" style="display: none;">
<h2><span class="zh">ğŸ“‹ é¢œè‰²è¯¦æƒ…</span><span class="en hidden">ğŸ“‹ Color Details</span><span class="ja hidden">ğŸ“‹ è‰²ã®è©³ç´°</span></h2>
<div class="details-grid">
<div class="detail-item"><span class="zh">RAL è‰²å·: </span><span class="en hidden">RAL Code: </span><span class="ja hidden">RALè‰²ç•ªå·: </span><strong id="ralCodeOutput"></strong></div>
<div class="detail-item"><span class="zh">ä¸­æ–‡åç§°: </span><span class="en hidden">Chinese Name: </span><span class="ja hidden">ä¸­å›½èªå: </span><strong id="nameCnOutput"></strong></div>
<div class="detail-item"><span class="zh">è‹±æ–‡åç§°: </span><span class="en hidden">English Name: </span><span class="ja hidden">è‹±èªå: </span><strong id="nameEnOutput"></strong></div>
<div class="detail-item"><span class="zh">æ—¥æ–‡åç§°: </span><span class="en hidden">Japanese Name: </span><span class="ja hidden">æ—¥æœ¬èªå: </span><strong id="nameJaOutput"></strong></div>
<div class="detail-item"><span class="zh">HEX è‰²ç : </span><span class="en hidden">HEX Code: </span><span class="ja hidden">HEXã‚³ãƒ¼ãƒ‰: </span><strong id="hexOutput"></strong></div>
<div class="detail-item"><span class="zh">LAB å€¼: </span><span class="en hidden">LAB Values: </span><span class="ja hidden">LABå€¤: </span><strong id="labOutput"></strong></div>
</div>

<h2 style="margin-top: 20px;"><span class="zh">ğŸ§ª é¢œæ–™é…æ–¹ (é€æ˜åŸºç¡€æ¼†ä¸“ç”¨)</span><span class="en hidden">ğŸ§ª Paint Recipe (For Clear Base)</span><span class="ja hidden">ğŸ§ª é¡”æ–™é…åˆ (ã‚¯ãƒªã‚¢ãƒ™ãƒ¼ã‚¹å°‚ç”¨)</span></h2>
<ul id="recipeList"></ul>
<p style="font-size: 0.8em; color: #7f8c8d; margin-top: 10px;"><span class="zh">* æ³¨æ„ï¼šé…æ–¹ä¸“ä¸ºé€æ˜åŸºç¡€æ¼†è®¾è®¡ï¼Œé¢œæ–™ç”¨é‡è¾ƒé«˜ä»¥ç¡®ä¿é®ç›–åŠ›ã€‚å®é™…è°ƒè‰²è¯·æ ¹æ®å…·ä½“é¢œæ–™å“ç‰Œå¾®è°ƒã€‚</span><span class="en hidden">* Note: Recipe designed for clear base paint with higher pigment content for opacity. Adjust according to specific pigment brands.</span><span class="ja hidden">* æ³¨æ„ï¼šã“ã®é…åˆã¯ã‚¯ãƒªã‚¢ãƒ™ãƒ¼ã‚¹å¡—æ–™å°‚ç”¨ã«è¨­è¨ˆã•ã‚Œã¦ãŠã‚Šã€éš è”½åŠ›ã‚’ç¢ºä¿ã™ã‚‹ãŸã‚é¡”æ–™ä½¿ç”¨é‡ãŒå¤šã‚ã§ã™ã€‚å®Ÿéš›ã®èª¿è‰²æ™‚ã¯ä½¿ç”¨ã™ã‚‹é¡”æ–™ãƒ–ãƒ©ãƒ³ãƒ‰ã«å¿œã˜ã¦å¾®èª¿æ•´ã—ã¦ãã ã•ã„ã€‚</span></p>

<div class="debug-info" id="debugInfo" style="display: none;">
<strong><span class="zh">è°ƒè¯•ä¿¡æ¯:</span><span class="en hidden">Debug Info:</span><span class="ja hidden">ãƒ‡ãƒãƒƒã‚°æƒ…å ±:</span></strong>
<div id="debugContent"></div>
</div>
</div>

<div id="errorMsg" class="error-message" style="display: none;"><span class="zh">æœªæ‰¾åˆ°è¯¥ RAL è‰²å·ï¼Œè¯·æ£€æŸ¥è¾“å…¥æˆ–å°è¯•å…¶ä»–è‰²å·ã€‚</span><span class="en hidden">RAL color code not found. Please check your input or try another code.</span><span class="ja hidden">RALè‰²ç•ªå·ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…¥åŠ›ã‚’ç¢ºèªã™ã‚‹ã‹ã€ä»–ã®è‰²ç•ªå·ã‚’ãŠè©¦ã—ãã ã•ã„ã€‚</span></div>
</div>

<script>
/* ======================== JavaScript æ ¸å¿ƒé€»è¾‘ (ä¿®å¤ä¼˜åŒ–ç‰ˆ) ======================== */

let currentLanguage = 'zh';
let currentColorData = null;

// é€æ˜åŸºç¡€æ¼†ä¸“ç”¨é¢œæ–™å¯†åº¦å’Œç€è‰²åŠ›æ•°æ®
const CLEAR_BASE_PIGMENTS = {
    white: { density: 4.2, tinting_strength: 1.0, opacity: 0.95 },
    black: { density: 1.8, tinting_strength: 8.5, opacity: 0.98 },
    red: { density: 5.2, tinting_strength: 1.2, opacity: 0.80 },
    yellow: { density: 5.8, tinting_strength: 1.5, opacity: 0.75 },
    blue: { density: 2.4, tinting_strength: 1.4, opacity: 0.70 },
    green: { density: 5.2, tinting_strength: 1.1, opacity: 0.85 },
    purple: { density: 1.4, tinting_strength: 2.2, opacity: 0.60 },
    brown: { density: 4.5, tinting_strength: 0.8, opacity: 0.80 }
};

// é¢œæ–™åç§°å¤šè¯­è¨€æ˜ å°„
const PIGMENT_NAMES = {
    white: { zh: 'ç™½è‰²é¢œæ–™', en: 'White Paint', ja: 'ç™½è‰²é¡”æ–™' },
    black: { zh: 'é»‘è‰²é¢œæ–™', en: 'Black Paint', ja: 'é»’è‰²é¡”æ–™' },
    red: { zh: 'çº¢è‰²é¢œæ–™', en: 'Red Paint', ja: 'èµ¤è‰²é¡”æ–™' },
    yellow: { zh: 'é»„è‰²é¢œæ–™', en: 'Yellow Paint', ja: 'é»„è‰²é¡”æ–™' },
    blue: { zh: 'è“è‰²é¢œæ–™', en: 'Blue Paint', ja: 'é’è‰²é¡”æ–™' },
    green: { zh: 'ç»¿è‰²é¢œæ–™', en: 'Green Paint', ja: 'ç·‘è‰²é¡”æ–™' },
    purple: { zh: 'ç´«è‰²é¢œæ–™', en: 'Purple Paint', ja: 'ç´«è‰²é¡”æ–™' },
    brown: { zh: 'æ£•è‰²é¢œæ–™', en: 'Brown Paint', ja: 'èŒ¶è‰²é¡”æ–™' }
};

// å•ä½æ–‡æœ¬å¤šè¯­è¨€æ˜ å°„
const UNITS = {
    parts: { zh: 'ä»½', en: 'parts', ja: 'éƒ¨' },
    grams: { zh: 'g', en: 'g', ja: 'g' },
    total_weight: { zh: 'æ€»é‡é‡', en: 'Total Weight', ja: 'ç·é‡é‡' }
};

// LAB è½¬ RGB å‡½æ•° (ä¿®å¤ç‰ˆ)
function labToRgb(L, a, b) {
    try {
        // LAB to XYZ
        let y = (L + 16) / 116;
        let x = a / 500 + y;
        let z = y - b / 200;

        // XYZ normalization
        const xn = 95.047;
        const yn = 100.000;
        const zn = 108.883;

        x = xn * (x > 0.206897 ? Math.pow(x, 3) : (x - 16/116) / 7.787);
        y = yn * (y > 0.206897 ? Math.pow(y, 3) : (y - 16/116) / 7.787);
        z = zn * (z > 0.206897 ? Math.pow(z, 3) : (z - 16/116) / 7.787);

        // XYZ to RGB
        x /= 100;
        y /= 100;
        z /= 100;

        let r = x * 3.2406 + y * -1.5372 + z * -0.4986;
        let g = x * -0.9689 + y * 1.8758 + z * 0.0415;
        let bl = x * 0.0557 + y * -0.2040 + z * 1.0570;

        // Gamma correction
        r = r > 0.0031308 ? 1.055 * Math.pow(r, 1/2.4) - 0.055 : 12.92 * r;
        g = g > 0.0031308 ? 1.055 * Math.pow(g, 1/2.4) - 0.055 : 12.92 * g;
        bl = bl > 0.0031308 ? 1.055 * Math.pow(bl, 1/2.4) - 0.055 : 12.92 * bl;

        // Clamp values
        r = Math.max(0, Math.min(1, r)) * 255;
        g = Math.max(0, Math.min(1, g)) * 255;
        bl = Math.max(0, Math.min(1, bl)) * 255;

        return [Math.round(r), Math.round(g), Math.round(bl)];
    } catch (error) {
        console.error('LAB to RGB conversion error:', error);
        return [128, 128, 128]; // è¿”å›ç°è‰²ä½œä¸ºé»˜è®¤å€¼
    }
}

// RGB è½¬ HEX å‡½æ•°
function rgbToHex(r, g, b) {
    return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}

// LAB è½¬ HEX å‡½æ•°
function labToHex(L, a, b) {
    const [r, g, bl] = labToRgb(L, a, b);
    return rgbToHex(r, g, bl);
}

// ä¿®å¤çš„ Delta E è®¡ç®—å‡½æ•° (CIE76)
function calculateDeltaE76(L1, a1, b1, L2, a2, b2) {
    try {
        const deltaL = L2 - L1;
        const deltaA = a2 - a1;
        const deltaB = b2 - b1;
        
        const deltaE = Math.sqrt(
            Math.pow(deltaL, 2) + 
            Math.pow(deltaA, 2) + 
            Math.pow(deltaB, 2)
        );
        
        return Math.round(deltaE * 100) / 100; // ä¿ç•™ä¸¤ä½å°æ•°
    } catch (error) {
        console.error('Delta E calculation error:', error);
        return 0;
    }
}

// æ›´æ–°é¢œè‰²é¢„è§ˆ (ä¿®å¤ç‰ˆ)
function updateColorPreview(previewId, L, a, b) {
    try {
        const preview = document.getElementById(previewId);
        if (!preview) return;
        
        if (isNaN(L) || isNaN(a) || isNaN(b)) {
            preview.style.backgroundColor = '#ccc';
            return;
        }
        
        const hex = labToHex(L, a, b);
        preview.style.backgroundColor = hex;
        
        // æ ¹æ®äº®åº¦è°ƒæ•´æ–‡å­—é¢œè‰²
        const textColor = L > 50 ? '#000' : '#fff';
        preview.style.color = textColor;
        
    } catch (error) {
        console.error('Color preview update error:', error);
    }
}

// è®¡ç®—è‰²å·®å‡½æ•° (ä¿®å¤ç‰ˆ)
function calculateDeltaE() {
    try {
        const targetL = parseFloat(document.getElementById('targetL').value);
        const targetA = parseFloat(document.getElementById('targetA').value);
        const targetB = parseFloat(document.getElementById('targetB').value);
        
        const actualL = parseFloat(document.getElementById('actualL').value);
        const actualA = parseFloat(document.getElementById('actualA').value);
        const actualB = parseFloat(document.getElementById('actualB').value);
        
        // éªŒè¯è¾“å…¥
        if (isNaN(targetL) || isNaN(targetA) || isNaN(targetB) || 
            isNaN(actualL) || isNaN(actualA) || isNaN(actualB)) {
            alert(currentLanguage === 'zh' ? 'è¯·è¾“å…¥æœ‰æ•ˆçš„LABå€¼' : 
                  currentLanguage === 'en' ? 'Please enter valid LAB values' : 
                  'æœ‰åŠ¹ãªLABå€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            return;
        }
        
        // éªŒè¯èŒƒå›´
        if (targetL < 0 || targetL > 100 || actualL < 0 || actualL > 100) {
            alert(currentLanguage === 'zh' ? 'Lå€¼å¿…é¡»åœ¨0-100ä¹‹é—´' : 
                  currentLanguage === 'en' ? 'L value must be between 0-100' : 
                  'Lå€¤ã¯0-100ã®é–“ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“');
            return;
        }
        
        if (targetA < -128 || targetA > 127 || actualA < -128 || actualA > 127 ||
            targetB < -128 || targetB > 127 || actualB < -128 || actualB > 127) {
            alert(currentLanguage === 'zh' ? 'aå’Œbå€¼å¿…é¡»åœ¨-128åˆ°127ä¹‹é—´' : 
                  currentLanguage === 'en' ? 'a and b values must be between -128 to 127' : 
                  'aã¨bå€¤ã¯-128ã‹ã‚‰127ã®é–“ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“');
            return;
        }
        
        // è®¡ç®—Delta E
        const deltaE = calculateDeltaE76(targetL, targetA, targetB, actualL, actualA, actualB);
        
        // æ˜¾ç¤ºç»“æœ
        const resultDiv = document.getElementById('deltaEResult');
        const valueDiv = document.getElementById('deltaEValue');
        const infoDiv = document.getElementById('deltaEInfo');
        
        if (resultDiv && valueDiv && infoDiv) {
            resultDiv.classList.remove('hidden');
            
            // æ ¹æ®Delta Eå€¼è®¾ç½®æ ·å¼å’Œæè¿°
            let className, description;
            if (deltaE <= 1.0) {
                className = 'delta-e-excellent';
                description = {
                    zh: 'ä¼˜ç§€ - äººçœ¼å‡ ä¹æ— æ³•å¯Ÿè§‰å·®å¼‚',
                    en: 'Excellent - Barely perceptible to human eyes',
                    ja: 'å„ªç§€ - äººé–“ã®ç›®ã«ã¯ã»ã¨ã‚“ã©çŸ¥è¦šã§ããªã„'
                };
            } else if (deltaE <= 2.0) {
                className = 'delta-e-good';
                description = {
                    zh: 'è‰¯å¥½ - ä»”ç»†è§‚å¯Ÿå¯å¯Ÿè§‰å¾®å°å·®å¼‚',
                    en: 'Good - Perceptible through close observation',
                    ja: 'è‰¯å¥½ - æ³¨æ„æ·±ãè¦³å¯Ÿã™ã‚‹ã¨çŸ¥è¦šã§ãã‚‹'
                };
            } else if (deltaE <= 10.0) {
                className = 'delta-e-good';
                description = {
                    zh: 'å¯æ¥å— - ä¸€çœ¼å°±èƒ½å¯Ÿè§‰å·®å¼‚',
                    en: 'Acceptable - Perceptible at a glance',
                    ja: 'è¨±å®¹ç¯„å›² - ä¸€ç›®ã§çŸ¥è¦šã§ãã‚‹'
                };
            } else {
                className = 'delta-e-poor';
                description = {
                    zh: 'å·®å¼‚è¾ƒå¤§ - é¢œè‰²æ˜æ˜¾ä¸åŒ',
                    en: 'Poor - Colors are noticeably different',
                    ja: 'å·®ãŒå¤§ãã„ - è‰²ãŒæ˜ã‚‰ã‹ã«ç•°ãªã‚‹'
                };
            }
            
            resultDiv.className = `delta-e-result ${className}`;
            valueDiv.textContent = `Delta E: ${deltaE}`;
            infoDiv.textContent = description[currentLanguage];
        }
        
    } catch (error) {
        console.error('Delta E calculation error:', error);
        alert(currentLanguage === 'zh' ? 'è®¡ç®—å‡ºé”™ï¼Œè¯·æ£€æŸ¥è¾“å…¥' : 
              currentLanguage === 'en' ? 'Calculation error, please check input' : 
              'è¨ˆç®—ã‚¨ãƒ©ãƒ¼ã€å…¥åŠ›ã‚’ç¢ºèªã—ã¦ãã ã•ã„');
    }
}

// ä½¿ç”¨å½“å‰é¢œè‰²å‡½æ•°
function useCurrentColor() {
    if (!currentColorData) {
        alert(currentLanguage === 'zh' ? 'è¯·å…ˆé€‰æ‹©ä¸€ä¸ªRALé¢œè‰²' : 
              currentLanguage === 'en' ? 'Please select a RAL color first' : 
              'ã¾ãšRALè‰²ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
    }
    
    try {
        // è§£æå½“å‰é¢œè‰²çš„LABå€¼
        const labMatch = currentColorData.lab.match(/L:([\d.-]+), a:([\d.-]+), b:([\d.-]+)/);
        if (labMatch) {
            const L = parseFloat(labMatch[1]);
            const a = parseFloat(labMatch[2]);
            const b = parseFloat(labMatch[3]);
            
            // å¡«å…¥ç›®æ ‡é¢œè‰²
            document.getElementById('targetL').value = L.toFixed(2);
            document.getElementById('targetA').value = a.toFixed(2);
            document.getElementById('targetB').value = b.toFixed(2);
            
            // æ›´æ–°é¢„è§ˆ
            updateColorPreview('targetColorPreview', L, a, b);
        }
    } catch (error) {
        console.error('Use current color error:', error);
    }
}

// é€æ˜åŸºç¡€æ¼†é…æ–¹è®¡ç®— (ä¼˜åŒ–ç‰ˆ)
function calculateClearBaseRecipe(L, a, b) {
    try {
        const recipe = {};
        
        // åŸºç¡€ç™½è‰²é¢œæ–™ç”¨é‡ (ç¡®ä¿é®ç›–åŠ›)
        const baseWhite = Math.max(20, 100 - L * 0.8);
        recipe.white = Math.round(baseWhite * 10) / 10;
        
        // è‰²ç›¸è®¡ç®—
        const chroma = Math.sqrt(a * a + b * b);
        const hue = Math.atan2(b, a) * 180 / Math.PI;
        const normalizedHue = hue < 0 ? hue + 360 : hue;
        
        // æ ¹æ®è‰²ç›¸å’Œé¥±å’Œåº¦æ·»åŠ é¢œæ–™
        if (chroma > 5) {
            const chromaFactor = Math.min(chroma / 50, 1);
            
            // çº¢è‰²ç³» (0-60åº¦, 300-360åº¦)
            if ((normalizedHue >= 0 && normalizedHue <= 60) || normalizedHue >= 300) {
                recipe.red = Math.round(chromaFactor * 25 * 10) / 10;
                if (normalizedHue <= 30 || normalizedHue >= 330) {
                    recipe.yellow = Math.round(chromaFactor * 10 * 10) / 10;
                }
            }
            
            // é»„è‰²ç³» (30-120åº¦)
            if (normalizedHue >= 30 && normalizedHue <= 120) {
                recipe.yellow = Math.round(chromaFactor * 30 * 10) / 10;
                if (normalizedHue >= 60) {
                    recipe.green = Math.round(chromaFactor * 15 * 10) / 10;
                }
            }
            
            // ç»¿è‰²ç³» (90-180åº¦)
            if (normalizedHue >= 90 && normalizedHue <= 180) {
                recipe.green = Math.round(chromaFactor * 25 * 10) / 10;
                if (normalizedHue >= 150) {
                    recipe.blue = Math.round(chromaFactor * 10 * 10) / 10;
                }
            }
            
            // è“è‰²ç³» (150-270åº¦)
            if (normalizedHue >= 150 && normalizedHue <= 270) {
                recipe.blue = Math.round(chromaFactor * 25 * 10) / 10;
                if (normalizedHue >= 210) {
                    recipe.purple = Math.round(chromaFactor * 15 * 10) / 10;
                }
            }
            
            // ç´«è‰²ç³» (240-330åº¦)
            if (normalizedHue >= 240 && normalizedHue <= 330) {
                recipe.purple = Math.round(chromaFactor * 20 * 10) / 10;
                if (normalizedHue >= 300) {
                    recipe.red = (recipe.red || 0) + Math.round(chromaFactor * 10 * 10) / 10;
                }
            }
        }
        
        // æ·»åŠ é»‘è‰²è°ƒèŠ‚äº®åº¦
        if (L < 50) {
            const blackAmount = Math.max(0, (50 - L) / 5);
            recipe.black = Math.round(blackAmount * 10) / 10;
        }
        
        // æ·»åŠ æ£•è‰²å¤„ç†æš—è‰²è°ƒ
        if (L < 40 && chroma < 20) {
            recipe.brown = Math.round((40 - L) / 4 * 10) / 10;
        }
        
        // æ¸…ç†é›¶å€¼
        Object.keys(recipe).forEach(key => {
            if (recipe[key] <= 0) {
                delete recipe[key];
            }
        });
        
        return recipe;
    } catch (error) {
        console.error('Recipe calculation error:', error);
        return { white: 40 };
    }
}

// è®¡ç®—é¢œæ–™é‡é‡ (ä¿®å¤ç‰ˆ)
function calculatePigmentWeight(percentage, totalVolume, pigmentType) {
    try {
        const pigment = CLEAR_BASE_PIGMENTS[pigmentType];
        if (!pigment) {
            return 0;
        }
        
        // åŸºç¡€æµ“åº¦è°ƒæ•´
        const baseConcentration = 0.15;
        const adjustedPercentage = percentage / pigment.tinting_strength;
        const weight = (adjustedPercentage / 100) * totalVolume * baseConcentration * pigment.density;
        
        return Math.round(weight * 10) / 10;
    } catch (error) {
        console.error('Weight calculation error:', error);
        return 0;
    }
}

// ä¸»è®¡ç®—å‡½æ•°
function calculateOptimizedRecipe(L, a, b) {
    return calculateClearBaseRecipe(L, a, b);
}

// RAL é¢œè‰²æ•°æ® (ä¿æŒåŸæœ‰æ•°æ®ä¸å˜)
const RAW_RAL_DATA = [
    { code: "1000", name_cn: "ç±³ç»¿è‰²", name_en: "Green Beige", name_ja: "ã‚°ãƒªãƒ¼ãƒ³ãƒ™ãƒ¼ã‚¸ãƒ¥", lab: [82.05, -2.12, 25.33] },
    { code: "1001", name_cn: "ç±³è‰²", name_en: "Beige", name_ja: "ãƒ™ãƒ¼ã‚¸ãƒ¥", lab: [80.47, 5.21, 30.12] },
    { code: "1002", name_cn: "æ²™é»„è‰²", name_en: "Sand Yellow", name_ja: "ã‚µãƒ³ãƒ‰ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [78.92, 7.45, 38.56] },
    { code: "1003", name_cn: "ä¿¡å·é»„", name_en: "Signal Yellow", name_ja: "ã‚·ã‚°ãƒŠãƒ«ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [82.34, 10.12, 78.45] },
    { code: "1004", name_cn: "é‡‘é»„", name_en: "Golden Yellow", name_ja: "ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [80.12, 8.95, 72.33] },
    { code: "1005", name_cn: "èœ‚èœœé»„", name_en: "Honey Yellow", name_ja: "ãƒãƒ‹ãƒ¼ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [76.45, 12.34, 65.22] },
    { code: "1006", name_cn: "ç‰ç±³é»„", name_en: "Maize Yellow", name_ja: "ãƒ¡ã‚¤ã‚ºã‚¤ã‚¨ãƒ­ãƒ¼", lab: [79.88, 9.76, 70.11] },
    { code: "1007", name_cn: "æ°´ä»™é»„", name_en: "Daffodil Yellow", name_ja: "ãƒ€ãƒ•ã‚©ãƒ‡ã‚£ãƒ«ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [81.22, 11.45, 75.33] },
    { code: "1011", name_cn: "æ£•ç±³è‰²", name_en: "Brown Beige", name_ja: "ãƒ–ãƒ©ã‚¦ãƒ³ãƒ™ãƒ¼ã‚¸ãƒ¥", lab: [70.55, 8.12, 28.44] },
    { code: "1012", name_cn: "æŸ æª¬é»„", name_en: "Lemon Yellow", name_ja: "ãƒ¬ãƒ¢ãƒ³ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [85.33, -2.45, 72.11] },
    { code: "1013", name_cn: "çç ç™½", name_en: "Oyster White", name_ja: "ã‚ªã‚¤ã‚¹ã‚¿ãƒ¼ãƒ›ãƒ¯ã‚¤ãƒˆ", lab: [92.12, 1.22, 3.11] },
    { code: "1014", name_cn: "è±¡ç‰™é»„", name_en: "Ivory", name_ja: "ã‚¢ã‚¤ãƒœãƒªãƒ¼", lab: [88.45, 2.33, 18.22] },
    { code: "1015", name_cn: "æµ…è±¡ç‰™", name_en: "Light Ivory", name_ja: "ãƒ©ã‚¤ãƒˆã‚¢ã‚¤ãƒœãƒªãƒ¼", lab: [90.12, 1.55, 12.33] },
    { code: "1016", name_cn: "ç¡«é»„é»„", name_en: "Sulfur Yellow", name_ja: "ã‚µãƒ«ãƒ•ã‚¡ãƒ¼ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [89.22, -5.11, 85.44] },
    { code: "1017", name_cn: "è—çº¢èŠ±é»„", name_en: "Saffron Yellow", name_ja: "ã‚µãƒ•ãƒ©ãƒ³ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [78.33, 15.22, 65.11] },
    { code: "1018", name_cn: "é”Œé»„", name_en: "Zinc Yellow", name_ja: "ã‚¸ãƒ³ã‚¯ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [90.45, -3.22, 88.33] },
    { code: "1019", name_cn: "ç°ç±³è‰²", name_en: "Grey Beige", name_ja: "ã‚°ãƒ¬ãƒ¼ãƒ™ãƒ¼ã‚¸ãƒ¥", lab: [72.22, 1.11, 12.44] },
    { code: "1020", name_cn: "æ©„æ¦„é»„", name_en: "Olive Yellow", name_ja: "ã‚ªãƒªãƒ¼ãƒ–ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [68.55, -2.22, 25.33] },
    { code: "1021", name_cn: "èœç±½é»„", name_en: "Rape Yellow", name_ja: "ãƒ¬ã‚¤ãƒ—ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [85.33, 5.22, 82.11] },
    { code: "1023", name_cn: "äº¤é€šé»„", name_en: "Traffic Yellow", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [83.22, 7.11, 80.44] },
    { code: "1024", name_cn: "èµ­é»„", name_en: "Ochre Yellow", name_ja: "ã‚ªãƒ¼ã‚«ãƒ¼ã‚¤ã‚¨ãƒ­ãƒ¼", lab: [70.33, 8.22, 40.55] },
    { code: "2000", name_cn: "é»„æ©™", name_en: "Yellow Orange", name_ja: "ã‚¤ã‚¨ãƒ­ãƒ¼ã‚ªãƒ¬ãƒ³ã‚¸", lab: [72.33, 28.22, 65.44] },
    { code: "2001", name_cn: "çº¢æ©™", name_en: "Red Orange", name_ja: "ãƒ¬ãƒƒãƒ‰ã‚ªãƒ¬ãƒ³ã‚¸", lab: [60.22, 45.11, 50.33] },
    { code: "2002", name_cn: "æœ±çº¢", name_en: "Vermilion", name_ja: "ãƒãƒ¼ãƒŸãƒªã‚ªãƒ³", lab: [58.44, 52.22, 48.11] },
    { code: "2003", name_cn: "æµ…æ©™", name_en: "Pastel Orange", name_ja: "ãƒ‘ã‚¹ãƒ†ãƒ«ã‚ªãƒ¬ãƒ³ã‚¸", lab: [75.22, 30.11, 60.33] },
    { code: "2004", name_cn: "çº¯æ©™", name_en: "Pure Orange", name_ja: "ãƒ”ãƒ¥ã‚¢ã‚ªãƒ¬ãƒ³ã‚¸", lab: [70.33, 40.22, 65.44] },
    { code: "2009", name_cn: "äº¤é€šæ©™", name_en: "Traffic Orange", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚ªãƒ¬ãƒ³ã‚¸", lab: [72.11, 38.22, 62.44] },
    { code: "2010", name_cn: "ä¿¡å·æ©™", name_en: "Signal Orange", name_ja: "ã‚·ã‚°ãƒŠãƒ«ã‚ªãƒ¬ãƒ³ã‚¸", lab: [70.22, 35.11, 60.33] },
    { code: "3000", name_cn: "ç«çº¢", name_en: "Flame Red", name_ja: "ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒƒãƒ‰", lab: [50.22, 65.11, 45.33] },
    { code: "3001", name_cn: "ä¿¡å·çº¢", name_en: "Signal Red", name_ja: "ã‚·ã‚°ãƒŠãƒ«ãƒ¬ãƒƒãƒ‰", lab: [48.44, 68.22, 42.11] },
    { code: "3002", name_cn: "æ·±çº¢", name_en: "Carmine Red", name_ja: "ã‚«ãƒ¼ãƒã‚¤ãƒ³ãƒ¬ãƒƒãƒ‰", lab: [46.22, 70.11, 40.33] },
    { code: "3003", name_cn: "çº¢å®çŸ³çº¢", name_en: "Ruby Red", name_ja: "ãƒ«ãƒ“ãƒ¼ãƒ¬ãƒƒãƒ‰", lab: [44.11, 72.22, 38.44] },
    { code: "3004", name_cn: "ç´«çº¢", name_en: "Purple Red", name_ja: "ãƒ‘ãƒ¼ãƒ—ãƒ«ãƒ¬ãƒƒãƒ‰", lab: [42.22, 60.11, 30.33] },
    { code: "3005", name_cn: "é…’çº¢", name_en: "Wine Red", name_ja: "ãƒ¯ã‚¤ãƒ³ãƒ¬ãƒƒãƒ‰", lab: [40.11, 55.22, 28.44] },
    { code: "3009", name_cn: "æ°§åŒ–çº¢", name_en: "Oxide Red", name_ja: "ã‚ªã‚­ã‚µã‚¤ãƒ‰ãƒ¬ãƒƒãƒ‰", lab: [38.22, 40.11, 20.33] },
    { code: "3011", name_cn: "æ£•çº¢", name_en: "Brown Red", name_ja: "ãƒ–ãƒ©ã‚¦ãƒ³ãƒ¬ãƒƒãƒ‰", lab: [36.44, 42.22, 18.55] },
    { code: "3012", name_cn: "ç±³çº¢", name_en: "Beige Red", name_ja: "ãƒ™ãƒ¼ã‚¸ãƒ¥ãƒ¬ãƒƒãƒ‰", lab: [65.22, 25.11, 20.33] },
    { code: "3013", name_cn: "ç•ªèŒ„çº¢", name_en: "Tomato Red", name_ja: "ãƒˆãƒãƒˆãƒ¬ãƒƒãƒ‰", lab: [55.33, 50.22, 35.44] },
    { code: "3014", name_cn: "å¤ç²‰çº¢", name_en: "Antique Pink", name_ja: "ã‚¢ãƒ³ãƒ†ã‚£ãƒ¼ã‚¯ãƒ”ãƒ³ã‚¯", lab: [70.22, 28.11, 18.33] },
    { code: "3015", name_cn: "æµ…ç²‰çº¢", name_en: "Light Pink", name_ja: "ãƒ©ã‚¤ãƒˆãƒ”ãƒ³ã‚¯", lab: [80.11, 20.22, 10.44] },
    { code: "3016", name_cn: "çŠç‘šçº¢", name_en: "Coral Red", name_ja: "ã‚³ãƒ¼ãƒ©ãƒ«ãƒ¬ãƒƒãƒ‰", lab: [58.22, 48.11, 32.33] },
    { code: "3017", name_cn: "ç«ç‘°çº¢", name_en: "Rose", name_ja: "ãƒ­ãƒ¼ã‚º", lab: [65.33, 35.22, 25.44] },
    { code: "3018", name_cn: "è‰è“çº¢", name_en: "Strawberry Red", name_ja: "ã‚¹ãƒˆãƒ­ãƒ™ãƒªãƒ¼ãƒ¬ãƒƒãƒ‰", lab: [62.44, 45.11, 30.22] },
    { code: "3020", name_cn: "äº¤é€šçº¢", name_en: "Traffic Red", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ¬ãƒƒãƒ‰", lab: [50.11, 70.22, 40.44] },
    { code: "3022", name_cn: "é²‘é±¼çº¢", name_en: "Salmon Pink", name_ja: "ã‚µãƒ¼ãƒ¢ãƒ³ãƒ”ãƒ³ã‚¯", lab: [68.33, 35.44, 25.11] },
    { code: "3027", name_cn: "è¦†ç›†å­çº¢", name_en: "Raspberry Red", name_ja: "ãƒ©ã‚ºãƒ™ãƒªãƒ¼ãƒ¬ãƒƒãƒ‰", lab: [45.22, 55.33, 35.44] },
    { code: "3028", name_cn: "çº¯çº¢", name_en: "Pure Red", name_ja: "ãƒ”ãƒ¥ã‚¢ãƒ¬ãƒƒãƒ‰", lab: [52.11, 68.44, 42.33] },
    { code: "3031", name_cn: "ä¸œæ–¹çº¢", name_en: "Orient Red", name_ja: "ã‚ªãƒªã‚¨ãƒ³ãƒˆãƒ¬ãƒƒãƒ‰", lab: [48.33, 65.22, 38.11] },
    { code: "4001", name_cn: "çº¢ç´«", name_en: "Red Lilac", name_ja: "ãƒ¬ãƒƒãƒ‰ãƒ©ã‚¤ãƒ©ãƒƒã‚¯", lab: [55.44, 45.11, 15.22] },
    { code: "4002", name_cn: "çº¢ç´«è‰²", name_en: "Red Violet", name_ja: "ãƒ¬ãƒƒãƒ‰ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ", lab: [52.22, 48.33, 12.44] },
    { code: "4003", name_cn: "çŸ³æ¥ çº¢", name_en: "Heather Violet", name_ja: "ãƒ˜ã‚¶ãƒ¼ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ", lab: [58.11, 42.22, 18.33] },
    { code: "4004", name_cn: "é…’çº¢ç´«", name_en: "Claret Violet", name_ja: "ã‚¯ãƒ©ãƒ¬ãƒƒãƒˆãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ", lab: [45.33, 38.44, 10.11] },
    { code: "4005", name_cn: "è“ç´«", name_en: "Blue Lilac", name_ja: "ãƒ–ãƒ«ãƒ¼ãƒ©ã‚¤ãƒ©ãƒƒã‚¯", lab: [60.22, 25.11, -15.33] },
    { code: "4006", name_cn: "äº¤é€šç´«", name_en: "Traffic Purple", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ‘ãƒ¼ãƒ—ãƒ«", lab: [48.44, 35.22, -8.11] },
    { code: "4007", name_cn: "ç´«ç½—å…°", name_en: "Purple Violet", name_ja: "ãƒ‘ãƒ¼ãƒ—ãƒ«ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ", lab: [42.11, 28.33, -12.44] },
    { code: "4008", name_cn: "ä¿¡å·ç´«", name_en: "Signal Violet", name_ja: "ã‚·ã‚°ãƒŠãƒ«ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ", lab: [46.22, 32.44, -10.22] },
    { code: "4009", name_cn: "æµ…ç´«", name_en: "Pastel Violet", name_ja: "ãƒ‘ã‚¹ãƒ†ãƒ«ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ", lab: [65.33, 22.11, -5.44] },
    { code: "5000", name_cn: "ç´«è“", name_en: "Violet Blue", name_ja: "ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆãƒ–ãƒ«ãƒ¼", lab: [38.44, 15.22, -25.33] },
    { code: "5001", name_cn: "ç»¿è“", name_en: "Green Blue", name_ja: "ã‚°ãƒªãƒ¼ãƒ³ãƒ–ãƒ«ãƒ¼", lab: [42.22, -8.11, -35.44] },
    { code: "5002", name_cn: "ç¾¤é’è“", name_en: "Ultramarine Blue", name_ja: "ã‚¦ãƒ«ãƒˆãƒ©ãƒãƒªãƒ³ãƒ–ãƒ«ãƒ¼", lab: [35.11, 12.33, -45.22] },
    { code: "5003", name_cn: "è“å®çŸ³è“", name_en: "Sapphire Blue", name_ja: "ã‚µãƒ•ã‚¡ã‚¤ã‚¢ãƒ–ãƒ«ãƒ¼", lab: [32.44, 8.22, -48.11] },
    { code: "5004", name_cn: "é»‘è“", name_en: "Black Blue", name_ja: "ãƒ–ãƒ©ãƒƒã‚¯ãƒ–ãƒ«ãƒ¼", lab: [28.33, 5.11, -35.44] },
    { code: "5005", name_cn: "ä¿¡å·è“", name_en: "Signal Blue", name_ja: "ã‚·ã‚°ãƒŠãƒ«ãƒ–ãƒ«ãƒ¼", lab: [40.22, 2.44, -52.33] },
    { code: "5007", name_cn: "äº®è“", name_en: "Brilliant Blue", name_ja: "ãƒ–ãƒªãƒªã‚¢ãƒ³ãƒˆãƒ–ãƒ«ãƒ¼", lab: [45.11, -5.22, -48.44] },
    { code: "5008", name_cn: "ç°è“", name_en: "Grey Blue", name_ja: "ã‚°ãƒ¬ãƒ¼ãƒ–ãƒ«ãƒ¼", lab: [48.33, -2.11, -25.22] },
    { code: "5009", name_cn: "å¤©è“", name_en: "Azure Blue", name_ja: "ã‚¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ–ãƒ«ãƒ¼", lab: [52.44, -8.33, -35.11] },
    { code: "5010", name_cn: "é›è“", name_en: "Gentian Blue", name_ja: "ã‚²ãƒ³ãƒã‚¢ãƒ³ãƒ–ãƒ«ãƒ¼", lab: [38.22, 5.44, -42.33] },
    { code: "5011", name_cn: "é’¢è“", name_en: "Steel Blue", name_ja: "ã‚¹ãƒãƒ¼ãƒ«ãƒ–ãƒ«ãƒ¼", lab: [44.11, -3.22, -28.44] },
    { code: "5012", name_cn: "æ·¡è“", name_en: "Light Blue", name_ja: "ãƒ©ã‚¤ãƒˆãƒ–ãƒ«ãƒ¼", lab: [65.33, -12.11, -38.22] },
    { code: "5013", name_cn: "é’´è“", name_en: "Cobalt Blue", name_ja: "ã‚³ãƒãƒ«ãƒˆãƒ–ãƒ«ãƒ¼", lab: [36.44, 8.33, -45.11] },
    { code: "5014", name_cn: "é¸½è“", name_en: "Pigeon Blue", name_ja: "ãƒ”ã‚¸ãƒ§ãƒ³ãƒ–ãƒ«ãƒ¼", lab: [58.22, -5.44, -22.33] },
    { code: "5015", name_cn: "å¤©è“", name_en: "Sky Blue", name_ja: "ã‚¹ã‚«ã‚¤ãƒ–ãƒ«ãƒ¼", lab: [62.11, -15.22, -32.44] },
    { code: "5017", name_cn: "äº¤é€šè“", name_en: "Traffic Blue", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ–ãƒ«ãƒ¼", lab: [42.33, -2.11, -48.22] },
    { code: "5018", name_cn: "ç»¿æ¾çŸ³è“", name_en: "Turquoise Blue", name_ja: "ã‚¿ãƒ¼ã‚³ã‚¤ã‚ºãƒ–ãƒ«ãƒ¼", lab: [55.44, -25.33, -18.11] },
    { code: "5019", name_cn: "å¤©é’è“", name_en: "Capri Blue", name_ja: "ã‚«ãƒ—ãƒªãƒ–ãƒ«ãƒ¼", lab: [48.22, -18.44, -35.33] },
    { code: "5020", name_cn: "æµ·è“", name_en: "Ocean Blue", name_ja: "ã‚ªãƒ¼ã‚·ãƒ£ãƒ³ãƒ–ãƒ«ãƒ¼", lab: [38.11, -8.22, -42.44] },
    { code: "5021", name_cn: "æ°´è“", name_en: "Water Blue", name_ja: "ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ–ãƒ«ãƒ¼", lab: [68.33, -22.11, -25.22] },
    { code: "5022", name_cn: "å¤œè“", name_en: "Night Blue", name_ja: "ãƒŠã‚¤ãƒˆãƒ–ãƒ«ãƒ¼", lab: [25.44, 2.33, -28.11] },
    { code: "5023", name_cn: "è¿œè“", name_en: "Distant Blue", name_ja: "ãƒ‡ã‚£ã‚¹ã‚¿ãƒ³ãƒˆãƒ–ãƒ«ãƒ¼", lab: [52.22, -12.44, -38.33] },
    { code: "5024", name_cn: "æ·¡è“", name_en: "Pastel Blue", name_ja: "ãƒ‘ã‚¹ãƒ†ãƒ«ãƒ–ãƒ«ãƒ¼", lab: [72.11, -15.33, -22.44] },
    { code: "6000", name_cn: "ç»¿è“", name_en: "Patina Green", name_ja: "ãƒ‘ãƒ†ã‚£ãƒŠã‚°ãƒªãƒ¼ãƒ³", lab: [45.22, -25.44, -8.11] },
    { code: "6001", name_cn: "ç¿ ç»¿", name_en: "Emerald Green", name_ja: "ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰ã‚°ãƒªãƒ¼ãƒ³", lab: [48.33, -35.22, 15.44] },
    { code: "6002", name_cn: "å¶ç»¿", name_en: "Leaf Green", name_ja: "ãƒªãƒ¼ãƒ•ã‚°ãƒªãƒ¼ãƒ³", lab: [42.11, -28.33, 22.22] },
    { code: "6003", name_cn: "æ©„æ¦„ç»¿", name_en: "Olive Green", name_ja: "ã‚ªãƒªãƒ¼ãƒ–ã‚°ãƒªãƒ¼ãƒ³", lab: [38.44, -15.22, 18.33] },
    { code: "6004", name_cn: "è“ç»¿", name_en: "Blue Green", name_ja: "ãƒ–ãƒ«ãƒ¼ã‚°ãƒªãƒ¼ãƒ³", lab: [35.22, -22.44, -5.11] },
    { code: "6005", name_cn: "è‹”è—“ç»¿", name_en: "Moss Green", name_ja: "ãƒ¢ã‚¹ã‚°ãƒªãƒ¼ãƒ³", lab: [32.33, -18.11, 12.44] },
    { code: "6006", name_cn: "ç°æ©„æ¦„ç»¿", name_en: "Grey Olive", name_ja: "ã‚°ãƒ¬ãƒ¼ã‚ªãƒªãƒ¼ãƒ–", lab: [28.44, -12.22, 8.33] },
    { code: "6007", name_cn: "ç“¶ç»¿", name_en: "Bottle Green", name_ja: "ãƒœãƒˆãƒ«ã‚°ãƒªãƒ¼ãƒ³", lab: [25.11, -15.33, 5.22] },
    { code: "6008", name_cn: "æ£•ç»¿", name_en: "Brown Green", name_ja: "ãƒ–ãƒ©ã‚¦ãƒ³ã‚°ãƒªãƒ¼ãƒ³", lab: [30.22, -8.44, 15.11] },
    { code: "6009", name_cn: "å†·æ‰ç»¿", name_en: "Fir Green", name_ja: "ãƒ•ã‚¡ãƒ¼ã‚°ãƒªãƒ¼ãƒ³", lab: [22.33, -12.11, 8.44] },
    { code: "6010", name_cn: "è‰ç»¿", name_en: "Grass Green", name_ja: "ã‚°ãƒ©ã‚¹ã‚°ãƒªãƒ¼ãƒ³", lab: [45.44, -32.22, 25.33] },
    { code: "6011", name_cn: "ç°ç»¿", name_en: "Reseda Green", name_ja: "ãƒ¬ã‚»ãƒ€ã‚°ãƒªãƒ¼ãƒ³", lab: [52.11, -18.33, 12.22] },
    { code: "6012", name_cn: "é»‘ç»¿", name_en: "Black Green", name_ja: "ãƒ–ãƒ©ãƒƒã‚¯ã‚°ãƒªãƒ¼ãƒ³", lab: [28.22, -15.44, 8.11] },
    { code: "6013", name_cn: "èŠ¹èœç»¿", name_en: "Reed Green", name_ja: "ãƒªãƒ¼ãƒ‰ã‚°ãƒªãƒ¼ãƒ³", lab: [48.33, -22.11, 18.44] },
    { code: "6014", name_cn: "é»„æ©„æ¦„ç»¿", name_en: "Yellow Olive", name_ja: "ã‚¤ã‚¨ãƒ­ãƒ¼ã‚ªãƒªãƒ¼ãƒ–", lab: [42.44, -8.22, 25.33] },
    { code: "6015", name_cn: "é»‘æ©„æ¦„ç»¿", name_en: "Black Olive", name_ja: "ãƒ–ãƒ©ãƒƒã‚¯ã‚ªãƒªãƒ¼ãƒ–", lab: [25.33, -5.11, 12.22] },
    { code: "6016", name_cn: "ç»¿", name_en: "Turquoise Green", name_ja: "ã‚¿ãƒ¼ã‚³ã‚¤ã‚ºã‚°ãƒªãƒ¼ãƒ³", lab: [55.44, -38.22, 8.33] },
    { code: "6017", name_cn: "äº”æœˆç»¿", name_en: "May Green", name_ja: "ãƒ¡ã‚¤ã‚°ãƒªãƒ¼ãƒ³", lab: [62.11, -42.33, 35.44] },
    { code: "6018", name_cn: "é»„ç»¿", name_en: "Yellow Green", name_ja: "ã‚¤ã‚¨ãƒ­ãƒ¼ã‚°ãƒªãƒ¼ãƒ³", lab: [68.22, -35.44, 45.11] },
    { code: "6019", name_cn: "æµ…ç»¿", name_en: "Pastel Green", name_ja: "ãƒ‘ã‚¹ãƒ†ãƒ«ã‚°ãƒªãƒ¼ãƒ³", lab: [75.33, -28.11, 25.22] },
    { code: "6020", name_cn: "é“¬ç»¿", name_en: "Chrome Green", name_ja: "ã‚¯ãƒ­ãƒ ã‚°ãƒªãƒ¼ãƒ³", lab: [38.44, -25.22, 15.33] },
    { code: "6021", name_cn: "è‹ç»¿", name_en: "Pale Green", name_ja: "ãƒšãƒ¼ãƒ«ã‚°ãƒªãƒ¼ãƒ³", lab: [72.11, -22.33, 18.44] },
    { code: "6022", name_cn: "æ©„æ¦„è¤", name_en: "Olive Drab", name_ja: "ã‚ªãƒªãƒ¼ãƒ–ãƒ‰ãƒ©ãƒ–", lab: [35.22, -8.44, 22.11] },
    { code: "6024", name_cn: "äº¤é€šç»¿", name_en: "Traffic Green", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚°ãƒªãƒ¼ãƒ³", lab: [48.33, -35.11, 28.22] },
    { code: "6025", name_cn: "è•¨ç»¿", name_en: "Fern Green", name_ja: "ãƒ•ã‚¡ãƒ¼ãƒ³ã‚°ãƒªãƒ¼ãƒ³", lab: [52.44, -28.22, 22.33] },
    { code: "6026", name_cn: "è›‹ç™½çŸ³ç»¿", name_en: "Opal Green", name_ja: "ã‚ªãƒ‘ãƒ¼ãƒ«ã‚°ãƒªãƒ¼ãƒ³", lab: [58.11, -32.33, 15.44] },
    { code: "6027", name_cn: "æµ…ç»¿", name_en: "Light Green", name_ja: "ãƒ©ã‚¤ãƒˆã‚°ãƒªãƒ¼ãƒ³", lab: [78.22, -25.44, 28.11] },
    { code: "6028", name_cn: "æ¾ç»¿", name_en: "Pine Green", name_ja: "ãƒ‘ã‚¤ãƒ³ã‚°ãƒªãƒ¼ãƒ³", lab: [32.33, -18.11, 12.22] },
    { code: "6029", name_cn: "è–„è·ç»¿", name_en: "Mint Green", name_ja: "ãƒŸãƒ³ãƒˆã‚°ãƒªãƒ¼ãƒ³", lab: [65.44, -22.22, 8.33] },
    { code: "6032", name_cn: "ä¿¡å·ç»¿", name_en: "Signal Green", name_ja: "ã‚·ã‚°ãƒŠãƒ«ã‚°ãƒªãƒ¼ãƒ³", lab: [55.11, -45.33, 35.22] },
    { code: "6033", name_cn: "è–„è·ç»¿", name_en: "Mint Turquoise", name_ja: "ãƒŸãƒ³ãƒˆã‚¿ãƒ¼ã‚³ã‚¤ã‚º", lab: [68.22, -35.44, 12.11] },
    { code: "6034", name_cn: "æŸ”å’Œç»¿", name_en: "Pastel Turquoise", name_ja: "ãƒ‘ã‚¹ãƒ†ãƒ«ã‚¿ãƒ¼ã‚³ã‚¤ã‚º", lab: [72.33, -28.11, 5.44] },
    { code: "7000", name_cn: "æ¾é¼ ç°", name_en: "Squirrel Grey", name_ja: "ã‚¹ã‚¯ã‚¤ãƒ¬ãƒ«ã‚°ãƒ¬ãƒ¼", lab: [68.44, 2.22, 8.11] },
    { code: "7001", name_cn: "é“¶ç°", name_en: "Silver Grey", name_ja: "ã‚·ãƒ«ãƒãƒ¼ã‚°ãƒ¬ãƒ¼", lab: [72.11, 1.33, 5.22] },
    { code: "7002", name_cn: "æ©„æ¦„ç°", name_en: "Olive Grey", name_ja: "ã‚ªãƒªãƒ¼ãƒ–ã‚°ãƒ¬ãƒ¼", lab: [58.22, -2.44, 12.33] },
    { code: "7003", name_cn: "è‹”è—“ç°", name_en: "Moss Grey", name_ja: "ãƒ¢ã‚¹ã‚°ãƒ¬ãƒ¼", lab: [55.33, -5.11, 8.44] },
    { code: "7004", name_cn: "ä¿¡å·ç°", name_en: "Signal Grey", name_ja: "ã‚·ã‚°ãƒŠãƒ«ã‚°ãƒ¬ãƒ¼", lab: [65.44, 1.22, 3.11] },
    { code: "7005", name_cn: "é¼ ç°", name_en: "Mouse Grey", name_ja: "ãƒã‚¦ã‚¹ã‚°ãƒ¬ãƒ¼", lab: [52.11, 2.33, 5.22] },
    { code: "7006", name_cn: "ç±³ç°", name_en: "Beige Grey", name_ja: "ãƒ™ãƒ¼ã‚¸ãƒ¥ã‚°ãƒ¬ãƒ¼", lab: [62.22, 3.44, 8.33] },
    { code: "7008", name_cn: "å¡å…¶ç°", name_en: "Khaki Grey", name_ja: "ã‚«ãƒ¼ã‚­ã‚°ãƒ¬ãƒ¼", lab: [48.33, 2.11, 12.44] },
    { code: "7009", name_cn: "ç»¿ç°", name_en: "Green Grey", name_ja: "ã‚°ãƒªãƒ¼ãƒ³ã‚°ãƒ¬ãƒ¼", lab: [45.44, -3.22, 8.11] },
    { code: "7010", name_cn: "ç„¦æ²¹ç°", name_en: "Tarpaulin Grey", name_ja: "ã‚¿ãƒ¼ãƒ—ã‚°ãƒ¬ãƒ¼", lab: [42.11, -1.33, 5.22] },
    { code: "7011", name_cn: "é“ç°", name_en: "Iron Grey", name_ja: "ã‚¢ã‚¤ã‚¢ãƒ³ã‚°ãƒ¬ãƒ¼", lab: [38.22, 1.44, 3.33] },
    { code: "7012", name_cn: "ç„æ­¦ç°", name_en: "Basalt Grey", name_ja: "ãƒã‚µãƒ«ãƒˆã‚°ãƒ¬ãƒ¼", lab: [35.33, 2.11, 4.44] },
    { code: "7013", name_cn: "æ£•ç°", name_en: "Brown Grey", name_ja: "ãƒ–ãƒ©ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼", lab: [48.44, 3.22, 8.11] },
    { code: "7015", name_cn: "æ¿å²©ç°", name_en: "Slate Grey", name_ja: "ã‚¹ãƒ¬ãƒ¼ãƒˆã‚°ãƒ¬ãƒ¼", lab: [32.11, 1.33, 2.22] },
    { code: "7016", name_cn: "æ— çƒŸç…¤ç°", name_en: "Anthracite Grey", name_ja: "ã‚¢ãƒ³ã‚¹ãƒ©ã‚µã‚¤ãƒˆã‚°ãƒ¬ãƒ¼", lab: [28.22, 2.44, 3.33] },
    { code: "7021", name_cn: "é»‘ç°", name_en: "Black Grey", name_ja: "ãƒ–ãƒ©ãƒƒã‚¯ã‚°ãƒ¬ãƒ¼", lab: [25.33, 1.11, 2.44] },
    { code: "7022", name_cn: "æš—ç°", name_en: "Umbra Grey", name_ja: "ã‚¢ãƒ³ãƒ–ãƒ©ã‚°ãƒ¬ãƒ¼", lab: [32.44, 2.22, 5.11] },
    { code: "7023", name_cn: "æ··å‡åœŸç°", name_en: "Concrete Grey", name_ja: "ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆã‚°ãƒ¬ãƒ¼", lab: [58.11, 1.33, 3.22] },
    { code: "7024", name_cn: "çŸ³å¢¨ç°", name_en: "Graphite Grey", name_ja: "ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼", lab: [35.22, 2.44, 4.33] },
    { code: "7026", name_cn: "èŠ±å²—å²©ç°", name_en: "Granite Grey", name_ja: "ã‚°ãƒ©ãƒŠã‚¤ãƒˆã‚°ãƒ¬ãƒ¼", lab: [42.33, 1.11, 2.44] },
    { code: "7030", name_cn: "çŸ³ç°ç°", name_en: "Stone Grey", name_ja: "ã‚¹ãƒˆãƒ¼ãƒ³ã‚°ãƒ¬ãƒ¼", lab: [65.44, 2.22, 5.33] },
    { code: "7031", name_cn: "è“ç°", name_en: "Blue Grey", name_ja: "ãƒ–ãƒ«ãƒ¼ã‚°ãƒ¬ãƒ¼", lab: [48.11, -2.33, -8.22] },
    { code: "7032", name_cn: "åµçŸ³ç°", name_en: "Pebble Grey", name_ja: "ãƒšãƒ–ãƒ«ã‚°ãƒ¬ãƒ¼", lab: [72.22, 1.44, 3.11] },
    { code: "7033", name_cn: "æ°´æ³¥ç°", name_en: "Cement Grey", name_ja: "ã‚»ãƒ¡ãƒ³ãƒˆã‚°ãƒ¬ãƒ¼", lab: [55.33, 2.11, 4.22] },
    { code: "7034", name_cn: "é»„ç°", name_en: "Yellow Grey", name_ja: "ã‚¤ã‚¨ãƒ­ãƒ¼ã‚°ãƒ¬ãƒ¼", lab: [62.44, 3.33, 8.44] },
    { code: "7035", name_cn: "æµ…ç°", name_en: "Light Grey", name_ja: "ãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼", lab: [78.11, 1.22, 2.33] },
    { code: "7036", name_cn: "é“‚ç°", name_en: "Platinum Grey", name_ja: "ãƒ—ãƒ©ãƒãƒŠã‚°ãƒ¬ãƒ¼", lab: [68.22, 2.44, 4.11] },
    { code: "7037", name_cn: "åœŸç°", name_en: "Dusty Grey", name_ja: "ãƒ€ã‚¹ãƒ†ã‚£ã‚°ãƒ¬ãƒ¼", lab: [52.33, 3.11, 6.22] },
    { code: "7038", name_cn: "ç›ç‘™ç°", name_en: "Agate Grey", name_ja: "ã‚¢ã‚²ãƒ¼ãƒˆã‚°ãƒ¬ãƒ¼", lab: [75.44, 1.33, 3.44] },
    { code: "7039", name_cn: "çŸ³è‹±ç°", name_en: "Quartz Grey", name_ja: "ã‚¯ã‚©ãƒ¼ãƒ„ã‚°ãƒ¬ãƒ¼", lab: [48.11, 2.22, 4.33] },
    { code: "7040", name_cn: "çª—ç°", name_en: "Window Grey", name_ja: "ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚°ãƒ¬ãƒ¼", lab: [65.22, 1.44, 2.11] },
    { code: "7042", name_cn: "äº¤é€šç° A", name_en: "Traffic Grey A", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚°ãƒ¬ãƒ¼A", lab: [58.33, 2.11, 3.22] },
    { code: "7043", name_cn: "äº¤é€šç° B", name_en: "Traffic Grey B", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚°ãƒ¬ãƒ¼B", lab: [32.44, 1.33, 2.44] },
    { code: "7044", name_cn: "ä¸å…‰ç°", name_en: "Silk Grey", name_ja: "ã‚·ãƒ«ã‚¯ã‚°ãƒ¬ãƒ¼", lab: [72.11, 2.22, 4.33] },
    { code: "7045", name_cn: "é¼ ç°", name_en: "Telegrey 1", name_ja: "ãƒ†ãƒ¬ã‚°ãƒ¬ãƒ¼1", lab: [62.22, 1.44, 3.11] },
    { code: "7046", name_cn: "ä¸­ç°", name_en: "Telegrey 2", name_ja: "ãƒ†ãƒ¬ã‚°ãƒ¬ãƒ¼2", lab: [52.33, 2.11, 4.22] },
    { code: "7047", name_cn: "æ·±ç°", name_en: "Telegrey 4", name_ja: "ãƒ†ãƒ¬ã‚°ãƒ¬ãƒ¼4", lab: [42.44, 1.33, 2.11] },
    { code: "8000", name_cn: "ç»¿æ£•", name_en: "Green Brown", name_ja: "ã‚°ãƒªãƒ¼ãƒ³ãƒ–ãƒ©ã‚¦ãƒ³", lab: [35.22, -8.11, 15.44] },
    { code: "8001", name_cn: "èµ­æ£•", name_en: "Ochre Brown", name_ja: "ã‚ªãƒ¼ã‚«ãƒ¼ãƒ–ãƒ©ã‚¦ãƒ³", lab: [38.44, 5.22, 18.33] },
    { code: "8002", name_cn: "ä¿¡å·æ£•", name_en: "Signal Brown", name_ja: "ã‚·ã‚°ãƒŠãƒ«ãƒ–ãƒ©ã‚¦ãƒ³", lab: [32.11, 8.33, 12.22] },
    { code: "8003", name_cn: "ç²˜åœŸæ£•", name_en: "Clay Brown", name_ja: "ã‚¯ãƒ¬ã‚¤ãƒ–ãƒ©ã‚¦ãƒ³", lab: [42.22, 12.44, 20.11] },
    { code: "8004", name_cn: "é“œæ£•", name_en: "Copper Brown", name_ja: "ã‚«ãƒƒãƒ‘ãƒ¼ãƒ–ãƒ©ã‚¦ãƒ³", lab: [28.33, 15.11, 8.44] },
    { code: "8007", name_cn: "é¹¿æ£•", name_en: "Fawn Brown", name_ja: "ãƒ•ã‚©ãƒ¼ãƒ³ãƒ–ãƒ©ã‚¦ãƒ³", lab: [45.44, 8.22, 22.33] },
    { code: "8008", name_cn: "æ©„æ¦„æ£•", name_en: "Olive Brown", name_ja: "ã‚ªãƒªãƒ¼ãƒ–ãƒ–ãƒ©ã‚¦ãƒ³", lab: [35.11, -2.33, 18.44] },
    { code: "8011", name_cn: "åšæœæ£•", name_en: "Nut Brown", name_ja: "ãƒŠãƒƒãƒˆãƒ–ãƒ©ã‚¦ãƒ³", lab: [38.22, 5.44, 15.11] },
    { code: "8012", name_cn: "çº¢æ£•", name_en: "Red Brown", name_ja: "ãƒ¬ãƒƒãƒ‰ãƒ–ãƒ©ã‚¦ãƒ³", lab: [32.44, 18.11, 12.33] },
    { code: "8014", name_cn: "æ·±æ£•", name_en: "Sepia Brown", name_ja: "ã‚»ãƒ”ã‚¢ãƒ–ãƒ©ã‚¦ãƒ³", lab: [25.33, 8.22, 10.44] },
    { code: "8015", name_cn: "æ —æ£•", name_en: "Chestnut Brown", name_ja: "ãƒã‚§ã‚¹ãƒŠãƒƒãƒˆãƒ–ãƒ©ã‚¦ãƒ³", lab: [42.11, 15.33, 18.22] },
    { code: "8016", name_cn: "æ¡ƒèŠ±å¿ƒæœ¨æ£•", name_en: "Mahogany Brown", name_ja: "ãƒãƒ›ã‚¬ãƒ‹ãƒ¼ãƒ–ãƒ©ã‚¦ãƒ³", lab: [28.44, 12.11, 8.33] },
    { code: "8017", name_cn: "å·§å…‹åŠ›æ£•", name_en: "Chocolate Brown", name_ja: "ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆãƒ–ãƒ©ã‚¦ãƒ³", lab: [22.22, 8.44, 6.11] },
    { code: "8019", name_cn: "ç°æ£•", name_en: "Grey Brown", name_ja: "ã‚°ãƒ¬ãƒ¼ãƒ–ãƒ©ã‚¦ãƒ³", lab: [35.33, 3.22, 8.44] },
    { code: "8022", name_cn: "é»‘æ£•", name_en: "Black Brown", name_ja: "ãƒ–ãƒ©ãƒƒã‚¯ãƒ–ãƒ©ã‚¦ãƒ³", lab: [18.11, 5.33, 4.22] },
    { code: "8023", name_cn: "æ©™æ£•", name_en: "Orange Brown", name_ja: "ã‚ªãƒ¬ãƒ³ã‚¸ãƒ–ãƒ©ã‚¦ãƒ³", lab: [48.22, 22.44, 25.11] },
    { code: "8024", name_cn: "ç±³æ£•", name_en: "Beige Brown", name_ja: "ãƒ™ãƒ¼ã‚¸ãƒ¥ãƒ–ãƒ©ã‚¦ãƒ³", lab: [52.33, 8.11, 18.44] },
    { code: "8025", name_cn: "æµ…æ£•", name_en: "Pale Brown", name_ja: "ãƒšãƒ¼ãƒ«ãƒ–ãƒ©ã‚¦ãƒ³", lab: [58.44, 12.22, 22.33] },
    { code: "8028", name_cn: "åœŸæ£•", name_en: "Terra Brown", name_ja: "ãƒ†ãƒ©ãƒ–ãƒ©ã‚¦ãƒ³", lab: [38.11, 15.44, 15.22] },
    { code: "9001", name_cn: "å¥¶æ²¹ç™½", name_en: "Cream", name_ja: "ã‚¯ãƒªãƒ¼ãƒ ", lab: [92.44, 2.11, 8.33] },
    { code: "9002", name_cn: "ç°ç™½", name_en: "Grey White", name_ja: "ã‚°ãƒ¬ãƒ¼ãƒ›ãƒ¯ã‚¤ãƒˆ", lab: [88.11, 1.22, 3.44] },
    { code: "9003", name_cn: "ä¿¡å·ç™½", name_en: "Signal White", name_ja: "ã‚·ã‚°ãƒŠãƒ«ãƒ›ãƒ¯ã‚¤ãƒˆ", lab: [95.22, 0.33, 1.11] },
    { code: "9004", name_cn: "ä¿¡å·é»‘", name_en: "Signal Black", name_ja: "ã‚·ã‚°ãƒŠãƒ«ãƒ–ãƒ©ãƒƒã‚¯", lab: [15.33, 1.44, 2.22] },
    { code: "9005", name_cn: "å¢¨é»‘", name_en: "Jet Black", name_ja: "ã‚¸ã‚§ãƒƒãƒˆãƒ–ãƒ©ãƒƒã‚¯", lab: [12.44, 0.11, 0.33] },
    { code: "9006", name_cn: "ç™½é“ç°", name_en: "White Aluminium", name_ja: "ãƒ›ãƒ¯ã‚¤ãƒˆã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ", lab: [82.11, 1.22, 2.44] },
    { code: "9007", name_cn: "ç°é“ç°", name_en: "Grey Aluminium", name_ja: "ã‚°ãƒ¬ãƒ¼ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ", lab: [58.22, 2.33, 3.11] },
    { code: "9010", name_cn: "çº¯ç™½", name_en: "Pure White", name_ja: "ãƒ”ãƒ¥ã‚¢ãƒ›ãƒ¯ã‚¤ãƒˆ", lab: [98.33, 0.22, 0.44] },
    { code: "9011", name_cn: "çŸ³å¢¨é»‘", name_en: "Graphite Black", name_ja: "ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆãƒ–ãƒ©ãƒƒã‚¯", lab: [18.44, 1.11, 1.22] },
    { code: "9016", name_cn: "äº¤é€šç™½", name_en: "Traffic White", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ›ãƒ¯ã‚¤ãƒˆ", lab: [94.11, 0.33, 1.44] },
    { code: "9017", name_cn: "äº¤é€šé»‘", name_en: "Traffic Black", name_ja: "ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ–ãƒ©ãƒƒã‚¯", lab: [16.22, 0.44, 0.11] },
    { code: "9018", name_cn: "ç°ç™½", name_en: "Papyrus White", name_ja: "ãƒ‘ãƒ”ãƒ«ã‚¹ãƒ›ãƒ¯ã‚¤ãƒˆ", lab: [90.33, 1.11, 2.22] }
];

// å¤„ç†RALæ•°æ®ï¼Œç”Ÿæˆæ˜ å°„è¡¨å’Œé€‰é¡¹
const ralPaintMap = {};
const ralSelectOptions = [];

RAW_RAL_DATA.forEach(item => {
    const labStr = `L:${item.lab[0].toFixed(2)}, a:${item.lab[1].toFixed(2)}, b:${item.lab[2].toFixed(2)}`;
    const hexColor = labToHex(item.lab[0], item.lab[1], item.lab[2]);
    const colorData = {
        ral: item.code,
        name_cn: item.name_cn,
        name_en: item.name_en,
        name_ja: item.name_ja,
        hex: hexColor,
        lab: labStr
    };
    ralPaintMap[item.code] = colorData;
    ralSelectOptions.push({
        value: item.code,
        name_cn: item.name_cn,
        name_en: item.name_en,
        name_ja: item.name_ja,
        hex: hexColor
    });
});

// DOM å…ƒç´ å¼•ç”¨
let ralInput, ralSelect, volumeSelect, colorPreview, colorDisplay, errorMsg, recipeList, colorGrid;

// é¡µé¢åˆå§‹åŒ– (ä¿®å¤ç‰ˆ)
function initializePage() {
    try {
        // è·å–DOMå…ƒç´ 
        ralInput = document.getElementById('ralInput');
        ralSelect = document.getElementById('ralSelect');
        volumeSelect = document.getElementById('volumeSelect');
        colorPreview = document.getElementById('colorPreview');
        colorDisplay = document.getElementById('colorDisplay');
        errorMsg = document.getElementById('errorMsg');
        recipeList = document.getElementById('recipeList');
        colorGrid = document.getElementById('colorGrid');
        
        // æ£€æŸ¥å…³é”®å…ƒç´ 
        if (!ralInput || !ralSelect || !volumeSelect || !colorPreview) {
            throw new Error('Critical DOM elements not found');
        }
        
        // åˆå§‹åŒ–å„ä¸ªæ¨¡å—
        initializeColorGrid();
        setupEventListeners();
        updatePlaceholders();
        updateSelectOptions();
        updateVolumeDisplay();
        
        console.log('MooCowè°ƒè‰²å·¥å…·åˆå§‹åŒ–æˆåŠŸ');
    } catch (error) {
        console.error('é¡µé¢åˆå§‹åŒ–å¤±è´¥:', error);
        const alertTexts = {
            zh: 'é¡µé¢åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•',
            en: 'Page initialization failed, please refresh and try again',
            ja: 'ãƒšãƒ¼ã‚¸ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’æ›´æ–°ã—ã¦å†è¯•è¡Œã—ã¦ãã ã•ã„'
        };
        alert(alertTexts[currentLanguage] || alertTexts.zh);
    }
}

// è¯­è¨€åˆ‡æ¢å‡½æ•° (ä¿®å¤ç‰ˆ)
function switchLanguage(lang) {
    try {
        currentLanguage = lang;
        
        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');
        
        // åˆ‡æ¢è¯­è¨€æ˜¾ç¤º
        document.querySelectorAll('.zh').forEach(el => {
            el.classList.toggle('hidden', lang !== 'zh');
        });
        document.querySelectorAll('.en').forEach(el => {
            el.classList.toggle('hidden', lang !== 'en');
        });
        document.querySelectorAll('.ja').forEach(el => {
            el.classList.toggle('hidden', lang !== 'ja');
        });
        
        // æ›´æ–°å„ç§æ–‡æœ¬
        updatePlaceholders();
        updateSelectOptions();
        updateVolumeDisplay();
        updateColorSwatchTooltips();
        
        // å¦‚æœæœ‰å½“å‰é¢œè‰²ï¼Œé‡æ–°æ˜¾ç¤º
        if (ralInput && ralInput.value.trim()) {
            const currentRal = ralInput.value.trim();
            if (/^\d{4}$/.test(currentRal)) {
                displayColorInfo(currentRal);
            }
        }
        
    } catch (error) {
        console.error('è¯­è¨€åˆ‡æ¢é”™è¯¯:', error);
    }
}

// æ›´æ–°è¾“å…¥æ¡†å ä½ç¬¦
function updatePlaceholders() {
    if (!ralInput) return;
    const placeholders = {
        zh: 'è¯·è¾“å…¥ RAL å››ä½è‰²å·',
        en: 'Enter 4-digit RAL code',
        ja: 'RAL4æ¡è‰²ç•ªå·ã‚’å…¥åŠ›'
    };
    ralInput.placeholder = placeholders[currentLanguage] || placeholders.zh;
}

// æ›´æ–°ä¸‹æ‹‰èœå•é€‰é¡¹ (ä¿®å¤ç‰ˆ)
function updateSelectOptions() {
    if (!ralSelect) return;
    
    // æ¸…ç©ºç°æœ‰é€‰é¡¹ï¼ˆé™¤äº†ç¬¬ä¸€ä¸ªé»˜è®¤é€‰é¡¹ï¼‰
    while (ralSelect.children.length > 1) {
        ralSelect.removeChild(ralSelect.lastChild);
    }
    
    // æ›´æ–°ç¬¬ä¸€ä¸ªé€‰é¡¹çš„æ–‡æœ¬
    const firstOption = ralSelect.children[0];
    if (firstOption) {
        const firstOptionTexts = {
            zh: 'è¯·é€‰æ‹© RAL è‰²å·...',
            en: 'Please select RAL color code...',
            ja: 'RALè‰²ç•ªå·ã‚’é¸æŠã—ã¦ãã ã•ã„...'
        };
        firstOption.textContent = firstOptionTexts[currentLanguage] || firstOptionTexts.zh;
    }
    
    // æ·»åŠ æ‰€æœ‰é¢œè‰²é€‰é¡¹
    ralSelectOptions.forEach(option => {
        const optionElement = document.createElement('option');
        optionElement.value = option.value;
        let optionText = `RAL ${option.value} - `;
        if (currentLanguage === 'zh') {
            optionText += option.name_cn;
        } else if (currentLanguage === 'en') {
            optionText += option.name_en;
        } else if (currentLanguage === 'ja') {
            optionText += option.name_ja;
        }
        optionElement.textContent = optionText;
        ralSelect.appendChild(optionElement);
    });
}

// æ›´æ–°å®¹é‡æ˜¾ç¤º
function updateVolumeDisplay() {
    if (!volumeSelect) return;
    const volumeDisplay = document.getElementById('volumeDisplay');
    if (!volumeDisplay) return;
    
    const selectedVolume = parseInt(volumeSelect.value);
    let displayText = '';
    if (selectedVolume === 500) {
        displayText = '500ml';
    } else if (selectedVolume === 1000) {
        displayText = '1L (1000ml)';
    } else if (selectedVolume === 5000) {
        displayText = '5L (5000ml)';
    } else if (selectedVolume === 20000) {
        displayText = '20L (20000ml)';
    }
    volumeDisplay.textContent = displayText;
}

// æ›´æ–°è‰²å—å·¥å…·æç¤º
function updateColorSwatchTooltips() {
    document.querySelectorAll('.color-swatch').forEach(swatch => {
        const ralCode = swatch.dataset.ralCode;
        const colorData = ralPaintMap[ralCode];
        const tooltip = swatch.querySelector('.tooltip');
        if (tooltip && colorData) {
            let tooltipText = `RAL ${ralCode} - `;
            if (currentLanguage === 'zh') {
                tooltipText += colorData.name_cn;
            } else if (currentLanguage === 'en') {
                tooltipText += colorData.name_en;
            } else if (currentLanguage === 'ja') {
                tooltipText += colorData.name_ja;
            }
            tooltip.textContent = tooltipText;
        }
    });
}

// åˆå§‹åŒ–è‰²å—ç½‘æ ¼
function initializeColorGrid() {
    if (!colorGrid) return;
    
    ralSelectOptions.forEach(option => {
        const swatch = document.createElement('div');
        swatch.className = 'color-swatch';
        swatch.style.backgroundColor = option.hex;
        swatch.dataset.ralCode = option.value;
        swatch.innerHTML = `${option.value}<div class="tooltip">RAL ${option.value} - ${option.name_cn}</div>`;
        
        // æ·»åŠ ç‚¹å‡»äº‹ä»¶
        swatch.addEventListener('click', function() {
            selectColor(option.value);
        });
        
        colorGrid.appendChild(swatch);
    });
}

// é€‰æ‹©é¢œè‰²å‡½æ•°
function selectColor(ralCode) {
    try {
        // æ›´æ–°è¾“å…¥æ¡†å’Œä¸‹æ‹‰èœå•
        if (ralInput) ralInput.value = ralCode;
        if (ralSelect) ralSelect.value = ralCode;
        
        // æ›´æ–°è‰²å—é€‰ä¸­çŠ¶æ€
        document.querySelectorAll('.color-swatch').forEach(swatch => {
            swatch.classList.remove('selected');
        });
        const selectedSwatch = document.querySelector(`[data-ral-code="${ralCode}"]`);
        if (selectedSwatch) {
            selectedSwatch.classList.add('selected');
        }
        
        // æ˜¾ç¤ºé¢œè‰²ä¿¡æ¯
        displayColorInfo(ralCode);
    } catch (error) {
        console.error('Color selection error:', error);
    }
}

// æ˜¾ç¤ºé¢œè‰²ä¿¡æ¯ (ä¿®å¤ç‰ˆ)
function displayColorInfo(ralCode) {
    try {
        const colorData = ralPaintMap[ralCode];
        if (!colorData) {
            showError();
            return;
        }
        
        currentColorData = colorData;
        
        // éšè—é”™è¯¯ä¿¡æ¯
        if (errorMsg) errorMsg.style.display = 'none';
        
        // æ˜¾ç¤ºé¢œè‰²è¯¦æƒ…åŒºåŸŸ
        if (colorDisplay) colorDisplay.style.display = 'block';
        
        // æ›´æ–°é¢œè‰²é¢„è§ˆ
        if (colorPreview) {
            colorPreview.style.backgroundColor = colorData.hex;
            colorPreview.innerHTML = `RAL ${ralCode}`;
            
            // æ ¹æ®äº®åº¦è°ƒæ•´æ–‡å­—é¢œè‰²
            const labMatch = colorData.lab.match(/L:([\d.-]+)/);
            if (labMatch) {
                const L = parseFloat(labMatch[1]);
                colorPreview.style.color = L > 50 ? '#000' : '#fff';
            }
        }
        
        // æ›´æ–°è¯¦æƒ…ä¿¡æ¯
        const elements = {
            ralCodeOutput: ralCode,
            nameCnOutput: colorData.name_cn,
            nameEnOutput: colorData.name_en,
            nameJaOutput: colorData.name_ja,
            hexOutput: colorData.hex,
            labOutput: colorData.lab
        };
        
        Object.entries(elements).forEach(([id, value]) => {
            const element = document.getElementById(id);
            if (element) element.textContent = value;
        });
        
        // è§£æLABå€¼å¹¶è®¡ç®—é…æ–¹
        const labMatch = colorData.lab.match(/L:([\d.-]+), a:([\d.-]+), b:([\d.-]+)/);
        if (labMatch) {
            const L = parseFloat(labMatch[1]);
            const a = parseFloat(labMatch[2]);
            const b = parseFloat(labMatch[3]);
            
            displayRecipe(L, a, b);
            showDebugInfo(ralCode, L, a, b);
        }
        
    } catch (error) {
        console.error('Display color info error:', error);
        showError();
    }
}

// æ˜¾ç¤ºé…æ–¹ (ä¿®å¤ç‰ˆ)
function displayRecipe(L, a, b) {
    if (!recipeList) return;
    
    try {
        const selectedVolume = parseInt(volumeSelect.value);
        const recipe = calculateOptimizedRecipe(L, a, b);
        
        recipeList.innerHTML = '';
        let totalWeight = 0;
        
        for (const [paint, percentage] of Object.entries(recipe)) {
            if (percentage > 0) {
                const li = document.createElement('li');
                const paintName = PIGMENT_NAMES[paint] ? PIGMENT_NAMES[paint][currentLanguage] : paint;
                const partText = UNITS.parts[currentLanguage];
                const weightText = UNITS.grams[currentLanguage];
                const weight = calculatePigmentWeight(percentage, selectedVolume, paint);
                totalWeight += weight;
                
                li.innerHTML = `<span>${paintName}</span><div><span class="paint-weight">${percentage} ${partText}</span><br><span class="paint-weight-grams">${weight} ${weightText}</span></div>`;
                recipeList.appendChild(li);
            }
        }
        
        // æ·»åŠ æ€»é‡é‡
        if (totalWeight > 0) {
            const totalLi = document.createElement('li');
            totalLi.style.borderTop = '2px solid #3498db';
            totalLi.style.fontWeight = 'bold';
            totalLi.innerHTML = `<span>${UNITS.total_weight[currentLanguage]}</span><span class="paint-weight-grams">${Math.round(totalWeight * 10) / 10}g</span>`;
            recipeList.appendChild(totalLi);
        }
        
    } catch (error) {
        console.error('é…æ–¹æ˜¾ç¤ºé”™è¯¯:', error);
        const errorTexts = {
            zh: 'é…æ–¹è®¡ç®—é”™è¯¯',
            en: 'Recipe calculation error',
            ja: 'é…åˆè¨ˆç®—ã‚¨ãƒ©ãƒ¼'
        };
        recipeList.innerHTML = `<li style="color: red;">${errorTexts[currentLanguage]}</li>`;
    }
}

// æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
function showDebugInfo(ralCode, L, a, b) {
    const debugInfo = document.getElementById('debugInfo');
    const debugContent = document.getElementById('debugContent');
    if (debugInfo && debugContent) {
        try {
            const recipe = calculateOptimizedRecipe(L, a, b);
            const chroma = Math.sqrt(a * a + b * b);
            const hue = Math.atan2(b, a) * 180 / Math.PI;
            const normalizedHue = hue < 0 ? hue + 360 : hue;
            
            const debugLabels = {
                zh: { ral: 'RAL', lab: 'LAB', chroma: 'è‰²åº¦', hue: 'è‰²ç›¸', recipe: 'é…æ–¹' },
                en: { ral: 'RAL', lab: 'LAB', chroma: 'Chroma', hue: 'Hue', recipe: 'Recipe' },
                ja: { ral: 'RAL', lab: 'LAB', chroma: 'å½©åº¦', hue: 'è‰²ç›¸', recipe: 'é…åˆ' }
            };
            const labels = debugLabels[currentLanguage];
            
            debugContent.innerHTML = `${labels.ral}: ${ralCode}<br>${labels.lab}: L=${L}, a=${a}, b=${b}<br>${labels.chroma}: ${Math.round(chroma * 100) / 100}<br>${labels.hue}: ${Math.round(normalizedHue * 100) / 100}Â°<br>${labels.recipe}: ${JSON.stringify(recipe, null, 2)}`;
            
            // æ£€æŸ¥URLå‚æ•°æ˜¯å¦æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('debug') === 'true') {
                debugInfo.style.display = 'block';
            }
        } catch (error) {
            const errorTexts = {
                zh: 'è°ƒè¯•ä¿¡æ¯é”™è¯¯',
                en: 'Debug info error',
                ja: 'ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚¨ãƒ©ãƒ¼'
            };
            debugContent.innerHTML = `${errorTexts[currentLanguage]}: ${error.message}`;
        }
    }
}

// éšè—é¢œè‰²ä¿¡æ¯
function hideColorInfo() {
    if (colorDisplay) colorDisplay.style.display = 'none';
    if (errorMsg) errorMsg.style.display = 'none';
    if (colorPreview) {
        colorPreview.style.backgroundColor = '#ccc';
        const previewTexts = {
            zh: 'è¾“å…¥è‰²å·æˆ–é€‰æ‹©è‰²å—è¿›è¡ŒæŸ¥è¯¢',
            en: 'Enter color code or select color swatch',
            ja: 'è‰²ç•ªå·ã‚’å…¥åŠ›ã™ã‚‹ã‹è‰²è¦‹æœ¬ã‚’é¸æŠ'
        };
        colorPreview.innerHTML = previewTexts[currentLanguage];
    }
    currentColorData = null;
}

// æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
function showError() {
    if (colorDisplay) colorDisplay.style.display = 'none';
    if (errorMsg) errorMsg.style.display = 'block';
    if (colorPreview) {
        colorPreview.style.backgroundColor = '#e74c3c';
        const errorTexts = {
            zh: 'æœªæ‰¾åˆ°è¯¥ RAL è‰²å·',
            en: 'RAL color code not found',
            ja: 'RALè‰²ç•ªå·ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“'
        };
        colorPreview.innerHTML = errorTexts[currentLanguage];
    }
    currentColorData = null;
}

// äº‹ä»¶ç›‘å¬å™¨è®¾ç½® (ä¿®å¤ç‰ˆ)
function setupEventListeners() {
    try {
        // RALè¾“å…¥æ¡†äº‹ä»¶
        if (ralInput) {
            ralInput.addEventListener('input', function() {
                const value = this.value.trim().toUpperCase();
                if (/^\d{4}$/.test(value)) {
                    displayColorInfo(value);
                    if (ralSelect) ralSelect.value = value;
                } else {
                    hideColorInfo();
                    if (ralSelect) ralSelect.value = '';
                }
            });
            
            ralInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const value = this.value.trim().toUpperCase();
                    if (/^\d{4}$/.test(value)) {
                        displayColorInfo(value);
                    }
                }
            });
        }
        
        // RALä¸‹æ‹‰èœå•äº‹ä»¶
        if (ralSelect) {
            ralSelect.addEventListener('change', function() {
                const selectedValue = this.value;
                if (selectedValue) {
                    if (ralInput) ralInput.value = selectedValue;
                    displayColorInfo(selectedValue);
                } else {
                    if (ralInput) ralInput.value = '';
                    hideColorInfo();
                }
            });
        }
        
        // å®¹é‡é€‰æ‹©äº‹ä»¶
        if (volumeSelect) {
            volumeSelect.addEventListener('change', function() {
                updateVolumeDisplay();
                if (ralInput && ralInput.value.trim()) {
                    const currentRal = ralInput.value.trim();
                    if (/^\d{4}$/.test(currentRal)) {
                        displayColorInfo(currentRal);
                    }
                }
            });
        }
        
        // LABè¾“å…¥æ¡†äº‹ä»¶ (ä¿®å¤ç‰ˆ)
        const labInputs = ['targetL', 'targetA', 'targetB', 'actualL', 'actualA', 'actualB'];
        labInputs.forEach(id => {
            const input = document.getElementById(id);
            if (input) {
                input.addEventListener('input', function() {
                    const isTarget = id.startsWith('target');
                    const previewId = isTarget ? 'targetColorPreview' : 'actualColorPreview';
                    const lInput = document.getElementById(isTarget ? 'targetL' : 'actualL');
                    const aInput = document.getElementById(isTarget ? 'targetA' : 'actualA');
                    const bInput = document.getElementById(isTarget ? 'targetB' : 'actualB');
                    
                    if (lInput && aInput && bInput) {
                        const L = parseFloat(lInput.value);
                        const a = parseFloat(aInput.value);
                        const b = parseFloat(bInput.value);
                        
                        if (!isNaN(L) && !isNaN(a) && !isNaN(b)) {
                            updateColorPreview(previewId, L, a, b);
                        }
                    }
                });
            }
        });
        
        console.log('äº‹ä»¶ç›‘å¬å™¨è®¾ç½®å®Œæˆ');
    } catch (error) {
        console.error('äº‹ä»¶ç›‘å¬å™¨è®¾ç½®å¤±è´¥:', error);
        return false;
    }
}

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
window.addEventListener('DOMContentLoaded', function() {
    initializePage();
});

// å¤‡ç”¨åˆå§‹åŒ–ï¼ˆé˜²æ­¢DOMContentLoadedå·²ç»è§¦å‘ï¼‰
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        initializePage();
    });
} else {
    initializePage();
}

// å…¨å±€å‡½æ•°æš´éœ²ï¼ˆä¾›HTMLä¸­çš„onclickä½¿ç”¨ï¼‰
window.switchLanguage = switchLanguage;
window.selectColor = selectColor;
window.displayColorInfo = displayColorInfo;
window.calculateDeltaE = calculateDeltaE;
window.useCurrentColor = useCurrentColor;

// è°ƒè¯•å‡½æ•°ï¼ˆå¯åœ¨æ§åˆ¶å°ä½¿ç”¨ï¼‰
window.debugColorTool = function() {
    console.log('RALé¢œè‰²æ•°æ®:', ralPaintMap);
    console.log('å½“å‰è¯­è¨€:', currentLanguage);
    console.log('å½“å‰é¢œè‰²æ•°æ®:', currentColorData);
    console.log('DOMå…ƒç´ çŠ¶æ€:', {
        ralInput: !!ralInput,
        ralSelect: !!ralSelect,
        volumeSelect: !!volumeSelect,
        colorPreview: !!colorPreview,
        colorDisplay: !!colorDisplay,
        errorMsg: !!errorMsg,
        recipeList: !!recipeList,
        colorGrid: !!colorGrid
    });
};

</script>
</body>
</html>
